

SET hive.execution.engine = spark;
SET spark.yarn.queue = root.dataeng;
SET hive.exec.dynamic.partition.mode = nonstrict;

INSERT overwrite TABLE bi_corp_common.bt_ren_result_dia_parquet PARTITION (partition_date)


select * from bi_corp_common.bt_ren_result_dia where partition_date > '2021-03-05'





SHOW CREATE TABLE bi_corp_common.bt_ren_result_dia_parquet ;

SHOW CREATE TABLE bi_corp_common.bt_ren_result_dia ;



DROP TABLE bi_corp_common.bt_ren_result_dia ;
CREATE EXTERNAL TABLE `bi_corp_common.bt_ren_result_dia`(
  `cod_ren_contrato` string, 
  `dt_ren_altacontrato` string, 
  `dt_ren_vencontrato` string, 
  `dt_ren_reestruccontrato` string, 
  `fc_ren_tasint` decimal(8,5), 
  `fc_ren_plazcontractual` int, 
  `cod_ren_producto_generic` string, 
  `cod_ren_contenido` string, 
  `dt_ren_fechadata` string, 
  `cod_ren_pais` string, 
  `cod_ren_pers_ods` string, 
  `cod_per_nup` bigint, 
  `cod_per_vinculacion` string, 
  `ds_per_vinculacion` string, 
  `ds_per_tipopersona` string, 
  `ds_per_nombre_apellido` string, 
  `flag_per_empleado` int, 
  `cod_ren_entidad_espana` string, 
  `cod_ren_producto_gest` string, 
  `cod_ren_divisa` string, 
  `cod_ren_reajuste` string, 
  `cod_ren_agrp_func` string, 
  `cod_ren_est_sdo` string, 
  `cod_ren_cont_gestion` string, 
  `cod_ren_area_negocio` string, 
  `cod_ren_tipo_ajuste` string, 
  `cod_ren_centro_cont` string, 
  `cod_ren_ofi_comercial` string, 
  `cod_ren_conciliacion` string, 
  `flag_ren_ind_pool` int, 
  `cod_ren_segmento_gest` string, 
  `cod_ren_gestor` string, 
  `cod_ren_gestor_prod` string, 
  `cod_ren_origen_inf` string, 
  `cod_ren_producto_niv_1` string, 
  `cod_ren_producto_niv_2` string, 
  `cod_ren_producto_niv_3` string, 
  `cod_ren_producto_niv_4` string, 
  `cod_ren_producto_niv_5` string, 
  `cod_ren_producto_niv_6` string, 
  `cod_ren_producto_niv_7` string, 
  `cod_ren_producto_niv_8` string, 
  `cod_ren_producto_niv_9` string, 
  `cod_ren_producto_niv_10` string, 
  `ds_ren_producto_niv_1` string, 
  `ds_ren_producto_niv_2` string, 
  `ds_ren_producto_niv_3` string, 
  `ds_ren_producto_niv_4` string, 
  `ds_ren_producto_niv_5` string, 
  `ds_ren_producto_niv_6` string, 
  `ds_ren_producto_niv_7` string, 
  `ds_ren_producto_niv_8` string, 
  `ds_ren_producto_niv_9` string, 
  `ds_ren_producto_niv_10` string, 
  `cod_ren_balance_niv_7` string, 
  `ds_ren_balance_niv_7` string, 
  `cod_ren_cta_resultados_niv_1` string, 
  `cod_ren_cta_resultados_niv_2` string, 
  `cod_ren_cta_resultados_niv_3` string, 
  `cod_ren_cta_resultados_niv_4` string, 
  `cod_ren_cta_resultados_niv_5` string, 
  `cod_ren_cta_resultados_niv_6` string, 
  `cod_ren_cta_resultados_niv_7` string, 
  `cod_ren_cta_resultados_niv_8` string, 
  `cod_ren_cta_resultados_niv_9` string, 
  `cod_ren_cta_resultados_niv_10` string, 
  `cod_ren_cta_resultados_niv_11` string, 
  `cod_ren_cta_resultados_niv_12` string, 
  `ds_ren_cta_resultados_niv_1` string, 
  `ds_ren_cta_resultados_niv_2` string, 
  `ds_ren_cta_resultados_niv_3` string, 
  `ds_ren_cta_resultados_niv_4` string, 
  `ds_ren_cta_resultados_niv_5` string, 
  `ds_ren_cta_resultados_niv_6` string, 
  `ds_ren_cta_resultados_niv_7` string, 
  `ds_ren_cta_resultados_niv_8` string, 
  `ds_ren_cta_resultados_niv_9` string, 
  `ds_ren_cta_resultados_niv_10` string, 
  `ds_ren_cta_resultados_niv_11` string, 
  `ds_ren_cta_resultados_niv_12` string, 
  `cod_ren_area_negocio_niv_1` string, 
  `cod_ren_area_negocio_niv_2` string, 
  `cod_ren_area_negocio_niv_3` string, 
  `cod_ren_area_negocio_niv_4` string, 
  `cod_ren_area_negocio_niv_5` string, 
  `cod_ren_area_negocio_niv_6` string, 
  `cod_ren_area_negocio_niv_7` string, 
  `cod_ren_area_negocio_niv_8` string, 
  `cod_ren_area_negocio_niv_9` string, 
  `ds_ren_area_negocio_niv_1` string, 
  `ds_ren_area_negocio_niv_2` string, 
  `ds_ren_area_negocio_niv_3` string, 
  `ds_ren_area_negocio_niv_4` string, 
  `ds_ren_area_negocio_niv_5` string, 
  `ds_ren_area_negocio_niv_6` string, 
  `ds_ren_area_negocio_niv_7` string, 
  `ds_ren_area_negocio_niv_8` string, 
  `ds_ren_area_negocio_niv_9` string, 
  `cod_ren_entidad_gest_niv_1` string, 
  `cod_ren_entidad_gest_niv_2` string, 
  `cod_ren_entidad_gest_niv_3` string, 
  `cod_ren_entidad_gest_niv_4` string, 
  `cod_ren_entidad_gest_niv_5` string, 
  `cod_ren_entidad_gest_niv_6` string, 
  `ds_ren_entidad_gest_niv_1` string, 
  `ds_ren_entidad_gest_niv_2` string, 
  `ds_ren_entidad_gest_niv_3` string, 
  `ds_ren_entidad_gest_niv_4` string, 
  `ds_ren_entidad_gest_niv_5` string, 
  `ds_ren_entidad_gest_niv_6` string, 
  `cod_ren_ofi_comercial_niv_5` string, 
  `cod_ren_ofi_comercial_niv_6` string, 
  `cod_ren_ofi_comercial_niv_7` string, 
  `cod_ren_ofi_comercial_niv_8` string, 
  `cod_ren_ofi_comercial_niv_9` string, 
  `cod_ren_ofi_comercial_niv_10` string, 
  `cod_ren_ofi_comercial_niv_11` string, 
  `ds_ren_ofi_comercial_niv_5` string, 
  `ds_ren_ofi_comercial_niv_6` string, 
  `ds_ren_ofi_comercial_niv_7` string, 
  `ds_ren_ofi_comercial_niv_8` string, 
  `ds_ren_ofi_comercial_niv_9` string, 
  `ds_ren_ofi_comercial_niv_10` string, 
  `ds_ren_ofi_comercial_niv_11` string, 
  `cod_ren_gestor_niv_1` string, 
  `cod_ren_gestor_niv_2` string, 
  `cod_ren_gestor_niv_3` string, 
  `cod_ren_gestor_niv_4` string, 
  `cod_ren_gestor_niv_5` string, 
  `cod_ren_gestor_niv_6` string, 
  `cod_ren_gestor_niv_7` string, 
  `cod_ren_gestor_niv_8` string, 
  `cod_ren_gestor_niv_9` string, 
  `cod_ren_gestor_niv_10` string, 
  `cod_ren_gestor_niv_11` string, 
  `ds_ren_gestor_niv_1` string, 
  `ds_ren_gestor_niv_2` string, 
  `ds_ren_gestor_niv_3` string, 
  `ds_ren_gestor_niv_4` string, 
  `ds_ren_gestor_niv_5` string, 
  `ds_ren_gestor_niv_6` string, 
  `ds_ren_gestor_niv_7` string, 
  `ds_ren_gestor_niv_8` string, 
  `ds_ren_gestor_niv_9` string, 
  `ds_ren_gestor_niv_10` string, 
  `ds_ren_gestor_niv_11` string, 
  `fc_ren_amrt_pri_ml` decimal(20,4), 
  `fc_ren_amrt_pri_mo` decimal(20,4), 
  `fc_ren_out_tti` decimal(20,4), 
  `fc_ren_ing_per_mo` decimal(20,4), 
  `fc_ren_ing_per_ml` decimal(20,4), 
  `fc_ren_ing_cap_ml` decimal(20,4), 
  `fc_ren_ing_cap_mo` decimal(20,4), 
  `fc_ren_ing_reaj_ml` decimal(20,4), 
  `fc_ren_egr_per_ml` decimal(20,4), 
  `fc_ren_egr_cap_ml` decimal(20,4), 
  `fc_ren_egr_reaj_ml` decimal(20,4), 
  `fc_ren_ajtti_egr_tb_cap_ml` decimal(20,4), 
  `fc_ren_ajtti_egr_sl_cap_ml` decimal(20,4), 
  `fc_ren_ajtti_egr_per_ml` decimal(20,4), 
  `fc_ren_ajtti_egr_reajuste_ml` decimal(20,4), 
  `fc_ren_ajtti_ing_tb_cap_ml` decimal(20,4), 
  `fc_ren_ajtti_ing_sl_cap_ml` decimal(20,4), 
  `fc_ren_ajtti_ing_per_ml` decimal(20,4), 
  `fc_ren_ajtti_ing_reajuste_ml` decimal(20,4), 
  `fc_ren_efec_enc_ml` decimal(20,4), 
  `fc_ren_ing_reaj_mo` decimal(20,4), 
  `fc_ren_egr_per_mo` decimal(20,4), 
  `fc_ren_egr_cap_mo` decimal(20,4), 
  `fc_ren_egr_reaj_mo` decimal(20,4), 
  `fc_ren_ajtti_egr_tb_cap_mo` decimal(20,4), 
  `fc_ren_ajtti_egr_sl_cap_mo` decimal(20,4), 
  `fc_ren_ajtti_egr_per_mo` decimal(20,4), 
  `fc_ren_ajtti_egr_reajuste_mo` decimal(20,4), 
  `fc_ren_ajtti_ing_tb_cap_mo` decimal(20,4), 
  `fc_ren_ajtti_ing_sl_cap_mo` decimal(20,4), 
  `fc_ren_ajtti_ing_per_mo` decimal(20,4), 
  `fc_ren_ajtti_ing_reajuste_mo` decimal(20,4), 
  `fc_ren_efec_enc_mo` decimal(20,4), 
  `fc_ren_sdo_med_cap_ml` decimal(20,4), 
  `fc_ren_sdo_med_int_ml` decimal(20,4), 
  `fc_ren_sdo_med_reajuste_ml` decimal(20,4), 
  `fc_ren_sdo_med_cap_mo` decimal(20,4), 
  `fc_ren_sdo_med_int_mo` decimal(20,4), 
  `fc_ren_sdo_med_reajuste_mo` decimal(20,4), 
  `fc_ren_sdo_cap_ml` decimal(20,4), 
  `fc_ren_sdo_cap_mo` decimal(20,4), 
  `fc_ren_sdo_int_ml` decimal(20,4), 
  `fc_ren_sdo_int_mo` decimal(20,4), 
  `fc_ren_sdo_reajuste_ml` decimal(20,4), 
  `fc_ren_sdo_reajuste_mo` decimal(20,4), 
  `fc_ren_ajtti_ing_tb_cap_sea_ml` decimal(20,4), 
  `fc_ren_ajtti_ing_tb_cap_sea_mo` decimal(20,4), 
  `fc_ren_ajtti_ing_sl_cap_sea_ml` decimal(20,4), 
  `fc_ren_ajtti_ing_sl_cap_sea_mo` decimal(20,4), 
  `fc_ren_ajtti_ing_per_sea_ml` decimal(20,4), 
  `fc_ren_ajtti_ing_per_sea_mo` decimal(20,4), 
  `fc_ren_ajtti_egr_tb_cap_sea_ml` decimal(20,4), 
  `fc_ren_ajtti_egr_tb_cap_sea_mo` decimal(20,4), 
  `fc_ren_ajtti_egr_sl_cap_sea_ml` decimal(20,4), 
  `fc_ren_ajtti_egr_sl_cap_sea_mo` decimal(20,4), 
  `fc_ren_ajtti_egr_per_sea_ml` decimal(20,4), 
  `fc_ren_ajtti_egr_per_sea_mo` decimal(20,4), 
  `fc_ren_efec_enc_sea_ml` decimal(20,4), 
  `fc_ren_efec_enc_sea_mo` decimal(20,4), 
  `fc_ren_saldo_puntual_ml` decimal(20,4), 
  `fc_ren_saldo_puntual_mo` decimal(20,4), 
  `fc_ren_saldo_medio_ml` decimal(20,4), 
  `fc_ren_saldo_medio_mo` decimal(20,4), 
  `fc_ren_ing_total_ficticio_ml` decimal(20,4), 
  `fc_ren_ing_total_ficticio_mo` decimal(20,4), 
  `fc_ren_egr_total_ficticio_ml` decimal(20,4), 
  `fc_ren_egr_total_ficticio_mo` decimal(20,4), 
  `fc_ren_ing_total_real_ml` decimal(20,4), 
  `fc_ren_ing_total_real_mo` decimal(20,4), 
  `fc_ren_egr_total_real_ml` decimal(20,4), 
  `fc_ren_egr_total_real_mo` decimal(20,4), 
  `cod_ren_signo` string, 
  `cod_ren_sis_origen` string)
PARTITIONED BY ( 
  `partition_date` string)
ROW FORMAT SERDE 
  'org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe' 
STORED AS INPUTFORMAT 
  'org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat' 
OUTPUTFORMAT 
  'org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat'
LOCATION
  'hdfs://namesrvprod/santander/bi-corp/common/rentabilidad/fact/bt_ren_result_dia'

	MSCK REPAIR TABLE bi_corp_common.bt_ren_result_dia ;
	


SELECT * FROM bi_corp_common.bt_ren_result_dia WHERE partition_date = '2021-04-15' AND cod_ren_contenido = 'CRE';