SELECT
	RE.idf_cto_ods, 
	RE.cod_contenido, 
	RE.fec_data,
	RE.cod_pais, 
	RE.idf_pers_ods, 
	RE.cod_entidad_espana, 
	RE.cod_producto_gest, 
	RE.cod_divisa, 
	RE.cod_reajuste, 
	RE.cod_agrp_func, 
	RE.cod_est_sdo, 
	RE.cod_cta_cont_gestion, 
	RE.cod_area_negocio, 
	RE.cod_tip_ajuste, 
	RE.cod_centro_cont, 
	RE.cod_ofi_comercial, 
	RE.cod_origen_inf, 
	RE.cod_sis_origen, 
	RE.ind_conciliacion, 
	RE.ind_entidad, 
	RE.tip_concepto_ctb, 
	RE.ind_pool, 
	RE.imp_sdo_cap_ml, 
	RE.imp_sdo_cap_mo, 
	RE.imp_sdo_int_ml, 
	RE.imp_sdo_int_mo, 
	RE.imp_sdo_reajuste_ml, 
	RE.imp_sdo_reajuste_mo, 
	RE.imp_sdo_insolv_ml, 
	RE.imp_sdo_insolv_mo, 
	RE.imp_sdo_cap_med_ml, 
	RE.imp_sdo_cap_med_mo, 
	RE.imp_sdo_med_int_ml, 
	RE.imp_sdo_med_int_mo, 
	RE.imp_sdo_med_reajuste_ml, 
	RE.imp_sdo_med_reajuste_mo, 
	RE.imp_sdo_med_insolv_ml, 
	RE.imp_sdo_med_insolv_mo, 
	RE.imp_egr_cap_ml, 
	RE.imp_egr_cap_mo, 
	RE.imp_egr_per_ml, 
	RE.imp_egr_per_mo, 
	RE.imp_egr_reaj_ml, 
	RE.imp_egr_reaj_mo, 
	RE.imp_ing_cap_ml, 
	RE.imp_ing_cap_mo, 
	RE.imp_ing_per_ml, 
	RE.imp_ing_per_mo, 
	RE.imp_ing_reaj_ml, 
	RE.imp_ing_reaj_mo, 
	RE.imp_ajtti_egr_tb_cap_ml, 
	RE.imp_ajtti_egr_tb_cap_mo, 
	RE.imp_ajtti_egr_sl_cap_ml, 
	RE.imp_ajtti_egr_sl_cap_mo, 
	RE.imp_ajtti_egr_per_ml, 
	RE.imp_ajtti_egr_per_mo, 
	RE.imp_ajtti_egr_reajuste_ml, 
	RE.imp_ajtti_egr_reajuste_mo, 
	RE.imp_ajtti_ing_tb_cap_ml, 
	RE.imp_ajtti_ing_tb_cap_mo, 
	RE.imp_ajtti_ing_sl_cap_ml, 
	RE.imp_ajtti_ing_sl_cap_mo,
	RE.imp_ajtti_ing_per_ml, 
	RE.imp_ajtti_ing_per_mo, 
	RE.imp_ajtti_ing_reajuste_ml, 
	RE.imp_ajtti_ing_reajuste_mo, 
	RE.imp_efec_enc_ml, 
	RE.imp_efec_enc_mo, 
	RE.imp_egr_cap_ml_acum, 
	RE.imp_egr_cap_mo_acum, 
	RE.imp_egr_per_ml_acum, 
	RE.imp_egr_per_mo_acum, 
	RE.imp_egr_reaj_ml_acum, 
	RE.imp_egr_reaj_mo_acum, 
	RE.imp_ing_cap_ml_acum, 
	RE.imp_ing_cap_mo_acum, 
	RE.imp_ing_per_ml_acum, 
	RE.imp_ing_per_mo_acum, 
	RE.imp_ing_reaj_ml_acum, 
	RE.imp_ing_reaj_mo_acum, 
	RE.imp_ajtti_ing_tb_cap_ml_acum, 
	RE.imp_ajtti_ing_tb_cap_mo_acum, 
	RE.imp_ajtti_ing_sl_cap_ml_acum, 
	RE.imp_ajtti_ing_sl_cap_mo_acum, 
	RE.imp_ajtti_ing_per_ml_acum, 
	RE.imp_ajtti_ing_per_mo_acum, 
	RE.imp_ajtti_ing_reajuste_ml_acum, 
	RE.imp_ajtti_ing_reajuste_mo_acum, 
	RE.imp_ajtti_egr_tb_cap_ml_acum, 
	RE.imp_ajtti_egr_tb_cap_mo_acum, 
	RE.imp_ajtti_egr_sl_cap_ml_acum, 
	RE.imp_ajtti_egr_sl_cap_mo_acum, 
	RE.imp_ajtti_egr_per_ml_acum, 
	RE.imp_ajtti_egr_per_mo_acum, 
	RE.imp_ajtti_egr_reajuste_ml_acum, 
	RE.imp_ajtti_egr_reajuste_mo_acum, 
	RE.imp_efec_enc_ml_acum, 
	RE.imp_efec_enc_mo_acum, 
	RE.var_imp_sdo_cap_mes_ant_ml, 
	RE.var_imp_sdo_cap_dic_ant_ml, 
	RE.var_imp_sdo_int_mes_ant_ml, 
	RE.var_imp_sdo_int_dic_ant_ml, 
	RE.ind_rem, 
	RE.origen_tasa, 
	RE.out_tti, 
	RE.out_tti_per, 
	RE.out_tti_sub, 
	RE.out_tti_remar, 
	RE.out_tti_volatil, 
	RE.out_tti_estab, 
	RE.spread_liq, 
	RE.spread_oper, 
	RE.tasa_base, 
	RE.tipo_tasa_adis, 
	RE.plz_prx_rev_x_sdo, 
	RE.plz_vto_rem_x_sdo, 
	RE.imp_tc_sdo_ml, 
	RE.imp_tti_sdo_ml, 
	RE.cla_operacion_com, 
	RE.idf_fondo, 
	RE.cod_tip_fondo, 
	RE.timest_umo, 
	RE.userid_umo, 
	RE.cod_proceso, 
	RE.cod_destino_fondo, 
	RE.cod_tip_coste, 
	RE.cod_promemoria, 
	RE.cod_lote, 
	RE.nom_fichero, 
	RE.fec_carga, 
	RE.ind_reparto, 
	RE.cod_posicion_valor, 
	RE.ind_devengo, 
	RE.cod_segmento_gest, 
	RE.cod_tip_tas, 
	RE.signo, 
	RE.cod_gestor, 
	RE.cod_usuario_alta, 
	RE.tipo_rtt,
	RE.imp_sdo_cap_dic_ml, 
	RE.imp_sdo_int_dic_ml, 
	RE.out_efenpuro_ml, 
	RE.out_efenpuro_mo, 
	RE.cod_cartera_gestion,
	RE.des_ajuste, 
	RE.cod_univ, 
	RE.cod_gestor_prod, 
	RE.partition_date,
	AN.cod_area_negocio_niv_1, 
	AN.cod_area_negocio_niv_2, 
	AN.cod_area_negocio_niv_3, 
	AN.cod_area_negocio_niv_4, 
	AN.cod_area_negocio_niv_5, 
	AN.cod_area_negocio_niv_6, 
	AN.cod_area_negocio_niv_7, 
	AN.cod_area_negocio_niv_8, 
	AN.cod_area_negocio_niv_9, 
	AN.cod_area_negocio_niv_10, 
	AN.cod_area_negocio_niv_11, 
	AN.cod_area_negocio_niv_12, 
	AN.cod_area_negocio_niv_13, 
	AN.cod_area_negocio_niv_14, 
	AN.des_area_negocio_niv_1, 
	AN.des_area_negocio_niv_2, 
	AN.des_area_negocio_niv_3, 
	AN.des_area_negocio_niv_4, 
	AN.des_area_negocio_niv_5, 
	AN.des_area_negocio_niv_6, 
	AN.des_area_negocio_niv_7, 
	AN.des_area_negocio_niv_8, 
	AN.des_area_negocio_niv_9, 
	AN.des_area_negocio_niv_10, 
	AN.des_area_negocio_niv_11,
	AN.des_area_negocio_niv_12,
	AN.des_area_negocio_niv_13, 
	AN.des_area_negocio_niv_14, 
	OFFI.cod_ofi_comercial,
	OFFI.cod_ofi_comercial_niv_1,
	OFFI.cod_ofi_comercial_niv_2,
	OFFI.cod_ofi_comercial_niv_3,
	OFFI.cod_ofi_comercial_niv_4,
	OFFI.cod_ofi_comercial_niv_5,
	OFFI.cod_ofi_comercial_niv_6,
	OFFI.cod_ofi_comercial_niv_7,
	OFFI.cod_ofi_comercial_niv_8,
	OFFI.cod_ofi_comercial_niv_9,
	OFFI.cod_ofi_comercial_niv_10,
	OFFI.cod_ofi_comercial_niv_11,
	OFFI.cod_ofi_comercial_niv_12,
	OFFI.cod_ofi_comercial_niv_13,
	OFFI.cod_ofi_comercial_niv_14,
	OFFI.des_ofi_comercial_niv_1,
	OFFI.des_ofi_comercial_niv_2,
	OFFI.des_ofi_comercial_niv_3,
	OFFI.des_ofi_comercial_niv_4,
	OFFI.des_ofi_comercial_niv_5,
	OFFI.des_ofi_comercial_niv_6,
	OFFI.des_ofi_comercial_niv_7,
	OFFI.des_ofi_comercial_niv_8,
	OFFI.des_ofi_comercial_niv_9,
	OFFI.des_ofi_comercial_niv_10,
	OFFI.des_ofi_comercial_niv_11,
	OFFI.des_ofi_comercial_niv_12,
	OFFI.des_ofi_comercial_niv_13,
	OFFI.des_ofi_comercial_niv_14,
	PROD.cod_producto_niv_1,
	PROD.cod_producto_niv_2,
	PROD.cod_producto_niv_3,
	PROD.cod_producto_niv_4,
	PROD.cod_producto_niv_5,
	PROD.cod_producto_niv_6,
	PROD.cod_producto_niv_7,
	PROD.cod_producto_niv_8,
	PROD.cod_producto_niv_9,
	PROD.cod_producto_niv_10,
	PROD.cod_producto_niv_11,
	PROD.cod_producto_niv_12,
	PROD.cod_producto_niv_13,
	PROD.cod_producto_niv_14,
	PROD.des_producto_niv_1,
	PROD.des_producto_niv_2,
	PROD.des_producto_niv_3,
	PROD.des_producto_niv_4,
	PROD.des_producto_niv_5,
	PROD.des_producto_niv_6,
	PROD.des_producto_niv_7,
	PROD.des_producto_niv_8,
	PROD.des_producto_niv_9,
	PROD.des_producto_niv_10,
	PROD.des_producto_niv_11,
	PROD.des_producto_niv_12,
	PROD.des_producto_niv_13,
	PROD.des_producto_niv_14,
	ENT.cod_entidad_gest_niv_1,
	ENT.cod_entidad_gest_niv_2,
	ENT.cod_entidad_gest_niv_3,
	ENT.cod_entidad_gest_niv_4,
	ENT.cod_entidad_gest_niv_5,
	ENT.cod_entidad_gest_niv_6,
	ENT.cod_entidad_gest_niv_7,
	ENT.cod_entidad_gest_niv_8,
	ENT.cod_entidad_gest_niv_9,
	ENT.cod_entidad_gest_niv_10,
	ENT.cod_entidad_gest_niv_11,
	ENT.cod_entidad_gest_niv_12,
	ENT.cod_entidad_gest_niv_13,
	ENT.cod_entidad_gest_niv_14,	
	ENT.des_entidad_gest_niv_1,
	ENT.des_entidad_gest_niv_2,
	ENT.des_entidad_gest_niv_3,
	ENT.des_entidad_gest_niv_4,
	ENT.des_entidad_gest_niv_5,
	ENT.des_entidad_gest_niv_6,
	ENT.des_entidad_gest_niv_7,
	ENT.des_entidad_gest_niv_8,
	ENT.des_entidad_gest_niv_9,
	ENT.des_entidad_gest_niv_10,
	ENT.des_entidad_gest_niv_11,
	ENT.des_entidad_gest_niv_12,
	ENT.des_entidad_gest_niv_13,
	ENT.des_entidad_gest_niv_14
	
FROM bi_corp_staging.rio157_ms0_ft_dwh_blce_result RE


INNER JOIN (select * FROM bi_corp_staging.rio157_ms0_dm_dwh_area_negocio_ aux_an
				WHERE aux_an.cod_jerq_adn01='JAN01' AND
				aux_an.partition_date in  (select max(partition_date) from bi_corp_staging.rio157_ms0_dm_dwh_area_negocio_ 
							where partition_date >= date_sub(partition_date,7) and partition_date <=to_date(current_date()) )
				) AS AN on RE.COD_AREA_NEGOCIO = AN.COD_AREA_NEGOCIO  
				
INNER JOIN (select * FROM bi_corp_staging.rio157_ms0_dm_dwh_oficina aux_offi
				WHERE aux_offi.cod_jerq_oc01='JOC01' AND
				aux_offi.partition_date in  (select max(partition_date) from bi_corp_staging.rio157_ms0_dm_dwh_oficina
							where partition_date >= date_sub(partition_date,7) and partition_date <=to_date(current_date()) )
				) AS OFFI on RE.COD_OFI_COMERCIAL = OFFI.COD_OFI_COMERCIAL
				
INNER JOIN (select * FROM bi_corp_staging.rio157_ms0_dm_dwh_productos_ aux_prod
				WHERE aux_prod.cod_jerq_pr01='JBLDN' AND
				aux_prod.partition_date in  (select max(partition_date) from bi_corp_staging.rio157_ms0_dm_dwh_productos_ 
							where partition_date >= date_sub(partition_date,7) and partition_date <=to_date(current_date()) )
				) AS PROD on RE.cod_producto_gest = PROD.COD_PRODUCTO
				
INNER JOIN (select * FROM bi_corp_staging.rio157_ms0_dm_dwh_entidad_juridica_ aux_ent
				WHERE aux_ent.partition_date in  (select max(partition_date) from bi_corp_staging.rio157_ms0_dm_dwh_entidad_juridica_  
							where partition_date >= date_sub(partition_date,7) and partition_date <=to_date(current_date()) )
				) AS ENT on RE.cod_entidad_espana = ENT.cod_entidad_gest 
				
WHERE RE.partition_date in (select max(partition_date) from bi_corp_staging.rio157_ms0_ft_dwh_blce_result
							where partition_date >= date_sub(partition_date,7) and partition_date <=to_date(current_date()) )