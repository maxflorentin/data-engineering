#### SGC cmdline manual por reprocesos.

#### gestion_estados	
sqoop import --connect 'jdbc:oracle:thin:@DBSORA6:1523/RIO56' --username 'SRVCBI'  --table "GEC01.GESTION_ESTADOS" --where "to_char(FEC_EST_GEST ,'YYYY-MM-DD') ='2020-06-07'" --target-dir  "/santander/bi-corp/landing/rio56/dim/gestion_estados/partition_date=2020-06-07" --num-mappers 6  --password 'F5byf8ZRxc7_mezy' --fields-terminated-by '^' --map-column-java COMENTARIO=String --delete-target-dir --split-by "IDE_GESTION_SECTOR" --verbose

spark2-submit --master yarn --conf spark.yarn.appMasterEnv.partition_date=2020-06-07 --conf spark.sql.sources.partitionOverwriteMode=dynamic --files /aplicaciones/bi/zonda/repositories/zonda-etl/scripts/layers/staging/rio56/dim/gestion_estados/gestion_estados_schema.json --py-files /aplicaciones/bi/zonda/repositories/guyra/src/config_file.py --num-executors 4 --executor-cores 4 --executor-memory 8G --name STAGING_GESTION_ESTADOS_Parquetize --verbose --queue root.dataeng --deploy-mode cluster /aplicaciones/bi/zonda/repositories/guyra/src/guyra.py gestion_estados_schema.json

#### gestiones
sqoop import --connect 'jdbc:oracle:thin:@DBSORA6:1523/RIO56' --username 'SRVCBI' --table "GEC01.GESTIONES" --where "to_char(FEC_BANDEJA_ACTUAL ,'YYYY-MM-DD') = '2020-06-07'" --target-dir  "/santander/bi-corp/landing/rio56/fact/gestiones/partition_date=2020-06-07"  --num-mappers 6  --password 'F5byf8ZRxc7_mezy' --fields-terminated-by '' --delete-target-dir  --verbose

spark2-submit --master yarn --conf spark.yarn.appMasterEnv.partition_date=2020-06-07 --conf spark.sql.sources.partitionOverwriteMode=dynamic --files /aplicaciones/bi/zonda/repositories/zonda-etl/scripts/layers/staging/rio56/fact/gestiones/gestiones_schema.json --py-files /aplicaciones/bi/zonda/repositories/guyra/src/config_file.py --num-executors 4 --executor-cores 4 --executor-memory 8G --name STAGING_GESTIONES_Parquetize --verbose --queue root.dataeng --deploy-mode cluster /aplicaciones/bi/zonda/repositories/guyra/src/guyra.py gestiones_schema.json


spark2-submit --master yarn --conf spark.yarn.appMasterEnv.partition_date=2020-06-08 --conf spark.sql.sources.partitionOverwriteMode=dynamic --files /aplicaciones/bi/zonda/repositories/zonda-etl/scripts/layers/staging/cosmos/dim/tipos_gestion/tipos_gestion_schema.json --py-files /aplicaciones/bi/zonda/repositories/guyra/src/config_file.py --num-executors 5 --executor-cores 4 --executor-memory 8G --name STAGING_tipos_gestion_Parquetize --verbose --queue root.dataeng --deploy-mode cluster /aplicaciones/bi/zonda/repositories/guyra/src/guyra.py tipos_gestion_schema.json

___________________________________________
sqoop import --connect 'jdbc:oracle:thin:@dblxopersrv03:7365/srv_rio258_ap'  --username 'srvcengineerlake' --query "select TEC.* from  CUPIER_USER.TRACKING_EVENT TE INNER JOIN CUPIER_USER.TRACKING_EVENT_COMPONENT TEC  ON TEC.TRACKING_EVENT_ID=TE.ID WHERE to_char(TE.EVENT_DATE ,'YYYY-MM-DD') ='2020-06-09' and \$CONDITIONS " --target-dir  '/santander/bi-corp/landing/rio258/fact/tracking_event_component/partition_date=2020-06-09'  -m 1  --password 'DBher_cnf89F_cv'  --delete-target-dir --fields-terminated-by '#' --verbose
___________________________________________

sqoop import --connect 'jdbc:oracle:thin:@DBSORA6:1523/RIO56'  --username 'SRVCBI'  --query "SELECT COD_ENTIDAD, IDE_GESTION_SECTOR, IDE_GESTION_NRO, IDE_CIRCUITO, INDI_TIPO_CIRC, INDI_DECISION_COMER, INDI_REPLTEO, INDI_RTA_INMED, INDI_IMPRE_CART, IMP_AUTZ_SOLICITADO, COD_MONE_SOLICITADO, IMP_AUTZ_AUTORIZADO, COD_MONE_AUTORIZADO, IMP_AUTZ_RESOLUCION, COD_MONE_RESOLUCION, TPO_PERS,COD_CRM,REGEXP_REPLACE(COMEN_CLIENTE , '(['||chr(10)||chr(11)||chr(13)||chr(9)||']+) > ') COMEN_CLIENTE,IDE_GEST_SECTOR_RELAC, IDE_GEST_NRO_RELAC, FEC_GESTION_ALTA, COD_BANDEJA_ACTUAL, FEC_BANDEJA_ACTUAL, COD_SECTOR_ACTUAL, INIC_USER_ALTA, INDI_MAIL, INDI_PRIORIDAD, FEC_MAX_RESOL, COD_CONFORME, COD_USER_ACTUAL,COD_GRUPO_EMPRESA, COD_TIPO_FAVORABILIDAD, FEC_AVISO_VENC FROM GEC01.GESTIONES WHERE to_char(FEC_BANDEJA_ACTUAL ,'YYYY-MM-DD') <= '2020-06-07' and \$CONDITIONS " --target-dir  '/santander/bi-corp/landing/rio56/fact/gestiones/partition_date=2020-06-07'  --m 1  --password 'F5byf8ZRxc7_mezy' --fields-terminated-by '^' --hive-drop-import-delims --map-column-java COMEN_CLIENTE=String --delete-target-dir  --escaped-by '^' --verbose


spark2-submit --master yarn --conf spark.yarn.appMasterEnv.partition_date=2020-06-07 --conf spark.sql.sources.partitionOverwriteMode=dynamic --files /aplicaciones/bi/zonda/repositories/zonda-etl/scripts/layers/staging/rio56/fact/gestiones/gestiones_schema.json --py-files /aplicaciones/bi/zonda/repositories/guyra/src/config_file.py --num-executors 4 --executor-cores 4 --executor-memory 8G --name STAGING_GESTIONES_Parquetize --verbose --queue root.dataeng --deploy-mode cluster /aplicaciones/bi/zonda/repositories/guyra/src/guyra.py gestiones_schema.json

___________________________________________

sqoop import --connect 'jdbc:oracle:thin:@DBSORA6:1523/RIO56'  --username 'SRVCBI'  --query "SELECT COD_ENTIDAD, IDE_GESTION_SECTOR, IDE_GESTION_NRO, IDE_CIRCUITO, INDI_TIPO_CIRC, INDI_DECISION_COMER, INDI_REPLTEO, INDI_RTA_INMED, INDI_IMPRE_CART, IMP_AUTZ_SOLICITADO, COD_MONE_SOLICITADO, IMP_AUTZ_AUTORIZADO, COD_MONE_AUTORIZADO, IMP_AUTZ_RESOLUCION, COD_MONE_RESOLUCION, TPO_PERS,COD_CRM,REGEXP_REPLACE(COMEN_CLIENTE , '(['||chr(10)||chr(11)||chr(13)||chr(9)||']+) > ') COMEN_CLIENTE,IDE_GEST_SECTOR_RELAC, IDE_GEST_NRO_RELAC, FEC_GESTION_ALTA, COD_BANDEJA_ACTUAL, FEC_BANDEJA_ACTUAL, COD_SECTOR_ACTUAL, INIC_USER_ALTA, INDI_MAIL, INDI_PRIORIDAD, FEC_MAX_RESOL, COD_CONFORME, COD_USER_ACTUAL,COD_GRUPO_EMPRESA, COD_TIPO_FAVORABILIDAD, FEC_AVISO_VENC FROM GEC01.GESTIONES WHERE to_char(FEC_BANDEJA_ACTUAL ,'YYYY-MM-DD') = '2020-06-08' and \$CONDITIONS " --target-dir  '/santander/bi-corp/landing/rio56/fact/gestiones/partition_date=2020-06-08'  --m 1  --password 'F5byf8ZRxc7_mezy' --fields-terminated-by '^' --hive-drop-import-delims --map-column-java COMEN_CLIENTE=String --delete-target-dir  --escaped-by '^' --verbose


spark2-submit --master yarn --conf spark.yarn.appMasterEnv.partition_date=2020-06-08 --conf spark.sql.sources.partitionOverwriteMode=dynamic --files /aplicaciones/bi/zonda/repositories/zonda-etl/scripts/layers/staging/rio56/fact/gestiones/gestiones_schema.json --py-files /aplicaciones/bi/zonda/repositories/guyra/src/config_file.py --num-executors 4 --executor-cores 4 --executor-memory 8G --name STAGING_GESTIONES_Parquetize --verbose --queue root.dataeng --deploy-mode cluster /aplicaciones/bi/zonda/repositories/guyra/src/guyra.py gestiones_schema.json

___________________________________________

sqoop import --connect 'jdbc:oracle:thin:@DBSORA6:1523/RIO56'  --username 'SRVCBI'  --query "SELECT COD_ENTIDAD, IDE_GESTION_SECTOR, IDE_GESTION_NRO, IDE_CIRCUITO, INDI_TIPO_CIRC, INDI_DECISION_COMER, INDI_REPLTEO, INDI_RTA_INMED, INDI_IMPRE_CART, IMP_AUTZ_SOLICITADO, COD_MONE_SOLICITADO, IMP_AUTZ_AUTORIZADO, COD_MONE_AUTORIZADO, IMP_AUTZ_RESOLUCION, COD_MONE_RESOLUCION, TPO_PERS,COD_CRM,REGEXP_REPLACE(COMEN_CLIENTE , '(['||chr(10)||chr(11)||chr(13)||chr(9)||']+) > ') COMEN_CLIENTE,IDE_GEST_SECTOR_RELAC, IDE_GEST_NRO_RELAC, FEC_GESTION_ALTA, COD_BANDEJA_ACTUAL, FEC_BANDEJA_ACTUAL, COD_SECTOR_ACTUAL, INIC_USER_ALTA, INDI_MAIL, INDI_PRIORIDAD, FEC_MAX_RESOL, COD_CONFORME, COD_USER_ACTUAL,COD_GRUPO_EMPRESA, COD_TIPO_FAVORABILIDAD, FEC_AVISO_VENC FROM GEC01.GESTIONES WHERE to_char(FEC_BANDEJA_ACTUAL ,'YYYY-MM-DD') = '2020-06-09' and \$CONDITIONS " --target-dir  '/santander/bi-corp/landing/rio56/fact/gestiones/partition_date=2020-06-09'  --m 1  --password 'F5byf8ZRxc7_mezy' --fields-terminated-by '^' --hive-drop-import-delims --map-column-java COMEN_CLIENTE=String --delete-target-dir  --escaped-by '^' --verbose


spark2-submit --master yarn --conf spark.yarn.appMasterEnv.partition_date=2020-06-09 --conf spark.sql.sources.partitionOverwriteMode=dynamic --files /aplicaciones/bi/zonda/repositories/zonda-etl/scripts/layers/staging/rio56/fact/gestiones/gestiones_schema.json --py-files /aplicaciones/bi/zonda/repositories/guyra/src/config_file.py --num-executors 4 --executor-cores 4 --executor-memory 8G --name STAGING_GESTIONES_Parquetize --verbose --queue root.dataeng --deploy-mode cluster /aplicaciones/bi/zonda/repositories/guyra/src/guyra.py gestiones_schema.json

___________________________________________

sqoop import --connect 'jdbc:oracle:thin:@DBSORA6:1523/RIO56'  --username 'SRVCBI'  --query "SELECT COD_ENTIDAD, IDE_GESTION_SECTOR, IDE_GESTION_NRO, IDE_CIRCUITO, INDI_TIPO_CIRC, INDI_DECISION_COMER, INDI_REPLTEO, INDI_RTA_INMED, INDI_IMPRE_CART, IMP_AUTZ_SOLICITADO, COD_MONE_SOLICITADO, IMP_AUTZ_AUTORIZADO, COD_MONE_AUTORIZADO, IMP_AUTZ_RESOLUCION, COD_MONE_RESOLUCION, TPO_PERS,COD_CRM,REGEXP_REPLACE(COMEN_CLIENTE , '(['||chr(10)||chr(11)||chr(13)||chr(9)||']+) > ') COMEN_CLIENTE,IDE_GEST_SECTOR_RELAC, IDE_GEST_NRO_RELAC, FEC_GESTION_ALTA, COD_BANDEJA_ACTUAL, FEC_BANDEJA_ACTUAL, COD_SECTOR_ACTUAL, INIC_USER_ALTA, INDI_MAIL, INDI_PRIORIDAD, FEC_MAX_RESOL, COD_CONFORME, COD_USER_ACTUAL,COD_GRUPO_EMPRESA, COD_TIPO_FAVORABILIDAD, FEC_AVISO_VENC FROM GEC01.GESTIONES WHERE to_char(FEC_BANDEJA_ACTUAL ,'YYYY-MM-DD') = '2020-06-10' and \$CONDITIONS " --target-dir  '/santander/bi-corp/landing/rio56/fact/gestiones/partition_date=2020-06-10'  --m 1  --password 'F5byf8ZRxc7_mezy' --fields-terminated-by '^' --hive-drop-import-delims --map-column-java COMEN_CLIENTE=String --delete-target-dir  --escaped-by '^' --verbose


spark2-submit --master yarn --conf spark.yarn.appMasterEnv.partition_date=2020-06-10 
--conf spark.sql.sources.partitionOverwriteMode=dynamic --files /aplicaciones/bi/zonda/repositories/zonda-etl/scripts/layers/staging/rio56/fact/gestiones/gestiones_schema.json 
--py-files /aplicaciones/bi/zonda/repositories/guyra/src/config_file.py 
--num-executors 4 --executor-cores 4 --executor-memory 8G 
--name STAGING_GESTIONES_Parquetize 
--verbose 
--queue root.dataeng --deploy-mode cluster /aplicaciones/bi/zonda/repositories/guyra/src/guyra.py gestiones_schema.json


spark2-submit --master yarn --conf spark.yarn.appMasterEnv.partition_date=2020-06-10 
--conf spark.sql.sources.partitionOverwriteMode=dynamic --files /aplicaciones/bi/zonda/repositories/zonda-etl/scripts/layers/staging/cosmos/fact/casuistica_motivos/casuistica_motivos_schema.json 
--py-files /aplicaciones/bi/zonda/repositories/guyra/src/config_file.py 
--num-executors 5 --executor-cores 4 --executor-memory 8G 
--name STAGING_casuistica_motivos_Parquetize 
--verbose 
--queue root.dataeng --deploy-mode cluster /aplicaciones/bi/zonda/repositories/guyra/src/guyra.py casuistica_motivos_schema.json
-----------------------


    "file": "casuistica_motivos",
    "location": "/santander/bi-corp/landing/csm/fact/casuistica_motivos/partition_date=${partition_date}",
    "destination": "/santander/bi-corp/staging/cosmos/fact/casuistica_motivos",
    "extension": "csv",
    "delimiter": ";",
    "header": true,
    "parquetFiles": 1,
    "createTable": "bi_corp_staging.cosmos_casuistica_motivos",
    "compression": "gzip",
    "columns": [
	
	"file": "gestiones",
    "location": "/santander/bi-corp/landing/rio56/fact/gestiones/partition_date=${partition_date}",
    "destination": "/santander/bi-corp/staging/rio56/fact/gestiones",
    "tempDirectory": "/santander/bi-corp/temp/gestiones",
    "extension": "csv",
    "delimiter": "^",
    "header": false,
    "parquetFiles": 1,
    "compression": "gzip",
    "columns": [
	
	
	
	
"
el cliente pago en dpolares el 01/04 y se imputo una parte de los pesos   a esos doalres, fv acreditar la diferencia del impuesto pais que falto ?

F.CIERRE: 21-05-20 S
untaje          F.VENCIM: 01-06-20 P.MIN $             0,00  U$         0,00  
 Fecha            Detalle                     Comp.       Pesos       Dolares 
             SALDOS ANTERIORES ..........               6.768,24       241,29 
3/04/20 CR.IMPUESTO PAIS 30%                             3724,24-             
4/05/20 SU PAGO EN PESOS         6728,24 TC 69,0000      3044,00-       53,39-
4/05/20 SU PAGO EN USD                                                 241,29-
1/11/19 AIR EUROPA LINEAS AEREAS BSPC.06/06  799817*     4336,86              
TOTAL TARJETA  4660 XXXX XXXX 1329  ......         4.336,86 *                 

"
"el cliente pago en dpolares el 01/04 y se imputo una parte de los pesos   a esos doalres, fv acreditar la diferencia del impuesto pais que falto ?> > > > F.CIERRE: 21-05-20 S> > untaje          F.VENCIM: 01-06-20 P.MIN $             0,00  U$         0,00  > >  Fecha            Detalle                     Comp.       Pesos       Dolares > >              SALDOS ANTERIORES ..........               6.768,24       241,29 > > 3/04/20 CR.IMPUESTO PAIS 30%                             3724,24-             > > 4/05/20 SU PAGO EN PESOS         6728,24 TC 69,0000      3044,00-       53,39-> > 4/05/20 SU PAGO EN USD                                                 241,29-> > 1/11/19 AIR EUROPA LINEAS AEREAS BSPC.06/06  799817*     4336,86              > > TOTAL TARJETA  4660 XXXX XXXX 1329  ......         4.336,86 *                 > > "
