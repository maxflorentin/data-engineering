{
    "logTable": "bi_corp_staging.rosetta_controles",
    "queries": [
            "select '${last_calendar_day}' as fecha_proceso,'Icaap - MDIM - new attribute' as cod_incidencia,count(distinct act.attribute_code) as num_reg_total,nvl(sum(case when ant.attribute_code is null then 1 else 0 end),0) as num_reg_error ,current_timestamp() as op_timestamp,'00004 - bi_corp.rosetta_mdim' as tabla from bi_corp_common.rosetta_mdim act left join bi_corp_common.rosetta_mdim ant on (act.attribute_code = ant.attribute_code and act.domain_code = ant.domain_code and ant.partition_date = add_months('${last_calendar_day}',-1)) where act.partition_date = '${last_calendar_day}' and act.domain_code = '00004'",
            "select '${last_calendar_day}' as fecha_proceso,'Icaap - TDIM - new dimension' as cod_incidencia,count(act.dimension_value) as num_reg_total,nvl(sum(case when ant.dimension_value is null then 1 else 0 end),0) as num_reg_error,current_timestamp() as op_timestamp,'00004 - bi_corp.rosetta_tdim' as tabla from bi_corp_common.rosetta_tdim act left join bi_corp_common.rosetta_tdim ant on (act.dimension_value = ant.dimension_value and act.domain_code = ant.domain_code and ant.partition_date = add_months('${last_calendar_day}',-1)) where act.partition_date = '${last_calendar_day}' and act.domain_code = '00004'",
            "select '${last_calendar_day}' as fecha_proceso,'Icaap - NKEY - master key null' as cod_incidencia,count(native_key) as num_reg_total,sum(case when master_key is null then 1 else 0 end) as num_reg_error,current_timestamp() as op_timestamp,'00004 - bi_corp.rosetta_nkey' as tabla from bi_corp_common.rosetta_nkey  where partition_date = '${last_calendar_day}' and domain_code = '00004'",
            "select '${last_calendar_day}' as fecha_proceso,'Icaap - RNKD - total global segmentation null' as cod_incidencia,count(native_key) as num_reg_total,sum(case when global_value is null and segmentation_type = '01' then 1 else 0 end) as num_reg_error,current_timestamp() as op_timestamp,'00004 - bi_corp.rosetta_rnkd' as tabla from bi_corp_common.rosetta_rnkd where partition_date = '${last_calendar_day}' and segmentation_type = '01' and domain_code = '00004'",
            "select '${last_calendar_day}' as fecha_proceso,'Icaap - RNKD - total local segmentation null' as cod_incidencia,count(native_key) as num_reg_total ,nvl(sum(case when global_value is null and segmentation_type = '02' then 1 else 0 end),0) as num_reg_error,current_timestamp() as op_timestamp,'00004 - bi_corp.rosetta_rnkd' as tabla from bi_corp_common.rosetta_rnkd where partition_date = '${last_calendar_day}' and segmentation_type = '02' and domain_code = '00004'",
            "select '${last_calendar_day}' as fecha_proceso,concat('Icaap - RNKD - ',segmentation_code,' - local segmentation null') as cod_incidencia,count(native_key) as num_reg_total ,nvl(sum(case when global_value is null and segmentation_type = '02' then 1 else 0 end),0) as num_reg_error,current_timestamp() as op_timestamp,concat('00004 - ',segmentation_code,' - bi_corp.rosetta_rnkd') as tabla from bi_corp_common.rosetta_rnkd where partition_date = '${last_calendar_day}' and segmentation_type = '02' and domain_code = '00004' group by segmentation_code",
			"select '${last_calendar_day}' as fecha_proceso,concat('Icaap - RNKD - ',segmentation_code,' - global segmentation null') as cod_incidencia,count(native_key) as num_reg_total ,nvl(sum(case when global_value is null and segmentation_type = '01' then 1 else 0 end),0) as num_reg_error,current_timestamp() as op_timestamp,concat('00004 - ',segmentation_code,' - bi_corp.rosetta_rnkd') as tabla from bi_corp_common.rosetta_rnkd where partition_date = '${last_calendar_day}' and segmentation_type = '01' and domain_code = '00004' group by segmentation_code"]
}