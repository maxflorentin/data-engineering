CREATE EXTERNAL TABLE IF NOT EXISTS bi_corp_common.stk_lsg_contratoactivo (
cod_lsg_idf_cto_ods                             string,
cod_lsg_contenido                               string,
cod_lsg_sis_origen                              string,
dt_lsg_fecha_data                               string,
cod_lsg_pais                                    int,
cod_lsg_entidad                                 string,
cod_lsg_centro                                  string,
cod_prod_producto                               string,
cod_prod_subproducto                            string,
cod_nro_cuenta                                  bigint,
cod_lsg_secuencia_cto                           string,
cod_div_divisa                                  string,
cod_lsg_reajuste                                string,
cod_lsg_per_nup                                 string,
cod_lsg_centro_cont                             string,
cod_lsg_oficina_comercial                       string,
cod_lsg_gestor_prod                             string,
cod_lsg_propuesta                               string,
cod_lsg_combo                                   string,
cod_lsg_idf_elem                                string,
cod_lsg_base_tasa_int                           string,
cod_lsg_bca_int                                 string,
cod_lsg_composicion_int                         string,
cod_lsg_modalidad_pago                          string,
cod_lsg_metodo_amrt                             string,
cod_lsg_curva_ref                               string,
cod_lsg_tipo_tasa                               string,
fc_lsg_tasa_int                                 decimal(8,5),
fc_lsg_tasa_int_min                             decimal(8,5),
fc_lsg_tasa_int_max                             decimal(8,5),
cod_lsg_tasa_int_excedido                       string,
fc_lsg_tasa_int_excedido                        decimal(8,5),
fc_lsg_tasa_dif_ind_ref                         decimal(8,5),
fc_lsg_tasa_dif_curva_coste                     decimal(8,5),
cod_lsg_sit_devengo                             string,
cod_lsg_peor_sit_cto                            string,
cod_lsg_peor_sit_cto_bis                        string,
dt_lsg_fecha_alta_cto                           string,
dt_lsg_fecha_inicio_gestion                     string,
dt_lsg_fecha_inicio_elem                        string,
dt_lsg_fecha_inicio_elem_gestion                string,
dt_lsg_fecha_cancela_anticipada                 string,
dt_lsg_fecha_descubierto                        string,
dt_lsg_fecha_primer_impago_vigente              string,
dt_lsg_fecha_fin_enganche                       string,
dt_lsg_fecha_ultima_liquid                      string,
dt_lsg_fecha_proxima_liquid                     string,
dt_lsg_fecha_ultima_revision                    string,
dt_lsg_fecha_proxima_revision                   string,
dt_lsg_fecha_vencimiento                        string,
dt_lsg_fecha_vencimiento_original               string,
int_lsg_frecuencia_pago_int                     int,
cod_lsg_unidad_frecuencia_pago_int              string,
int_lsg_frecuencia_revision_int                 int,
cod_lsg_unidad_frecuencia_revision_int          string,
cod_lsg_plz_contractual                         int,
int_lsg_plz_amrt                                int,
cod_lsg_unidad_plz_amrt                         string,
int_lsg_plz_pendiente                           int,
int_lsg_plz_medio_vencimiento                   int,
cod_lsg_unidad_plzmedio_vencimiento             string,
int_lsg_periodo_lag                             int,
cod_lsg_unidad_periodo_lag                      string,
int_lsg_reprecios                               int,
fc_lsg_imp_inicial_mo                           decimal(20,4),
fc_lsg_imp_cuota_mo                             decimal(20,4),
fc_lsg_imp_cuota_inicial_mo                     decimal(20,4),
int_lsg_cuotas_pactadas                         int,
int_lsg_cuotas_pendientes                       int,
fc_lsg_imp_amrt_pral_ml                         decimal(20,4),
fc_lsg_imp_amrt_pral_mo                         decimal(20,4),
fc_lsg_imp_limite_credito_total                 decimal(20,4),
fc_lsg_imp_limite_credito_ml                    decimal(20,4),
fc_lsg_imp_limite_credito_mo                    decimal(20,4),
fc_lsg_imp_limite_medio_mes_ml                  decimal(20,4),
fc_lsg_imp_limite_medio_mes_mo                  decimal(20,4),
int_lsg_num_dias_demora                         int,
fc_lsg_imp_mora1_ml                             decimal(20,4),
fc_lsg_imp_mora2_ml                             decimal(20,4),
fc_lsg_imp_mora3_ml                             decimal(20,4),
fc_lsg_imp_mora4_ml                             decimal(20,4),
fc_lsg_imp_mora5_ml                             decimal(20,4),
fc_lsg_imp_pago_ml                              decimal(20,4),
fc_lsg_imp_pago_mo                              decimal(20,4),
fc_lsg_imp_saliente_castigado_ml                decimal(20,4),
fc_lsg_imp_saliente_castigado_mo                decimal(20,4),
fc_lsg_imp_saldo_fallido_ml                     decimal(20,4),
fc_lsg_imp_saldo_fallido_mo                     decimal(20,4),
fc_lsg_imp_saldo_vencido_ml                     decimal(20,4),
fc_lsg_imp_saldo_vencido_mo                     decimal(20,4),
flag_lsg_cancelacion_anticipada                 int,
fc_lsg_sdo_cancelado_anticipado_ml              decimal(20,4),
fc_lsg_sdo_cancelado_anticipado_mo              decimal(20,4),
cod_lsg_fuera_blce                              string,
flag_lsg_refinanciacion                         int,
flag_lsg_titulizado                             int,
flag_lsg_cambio_condiciones                     int,
flag_lsg_limite_cancelable                      int,
flag_lsg_cto_casado                             int,
cod_lsg_producto_cto_casado                     string,
cod_lsg_subproducto_cto_casado                  string,
cod_lsg_cto_pas_casado                          string,
flag_lsg_cto_incentivado                        int,
flag_lsg_cto_renovado                           int,
flag_lsg_cto_singular_tesoreria                 int,
flag_lsg_cto_subvencionado                      int,
flag_lsg_cto_derivado                           int,
cod_lsg_tipo_origen_fondo_activo                string,
cod_lsg_fondo_ajeno_activo                      string,
flag_lsg_interes_cto_ml                         int,
fc_lsg_sdo_int_diferido_ml                      decimal(20,4),
fc_lsg_sdo_int_diferido_mo                      decimal(20,4),
fc_lsg_sdo_medio_acum_int_diferido_ml           decimal(20,4),
fc_lsg_sdo_medio_acum_int_diferido_mo           decimal(20,4),
fc_lsg_imp_int_cobrado_pagado_ml                decimal(20,4),
fc_lsg_imp_int_cobrado_pagado_mo                decimal(20,4),
fc_lsg_int_excedido_ml                          decimal(20,4),
fc_lsg_int_excedido_mo                          decimal(20,4),
int_lsg_efectos                                 int,
int_lsg_disposiciones                           int,
fc_lsg_sdo_precio_ml                            decimal(20,4),
fc_lsg_sdo_precio_mo                            decimal(20,4),
fc_lsg_sdo_excedido_sobre_limite_ml             decimal(20,4),
fc_lsg_sdo_excedido_sobre_limite_mo             decimal(20,4),
fc_lsg_sdo_medio_excedido_sobre_limite_ml       decimal(20,4),
fc_lsg_sdo_medio_excedido_sobre_limite_mo       decimal(20,4),
fc_lsg_sdo_dispuesto_ml                         decimal(20,4),
fc_lsg_sdo_dispuesto_mo                         decimal(20,4),
fc_lsg_sdo_medio_no_dispuesto_linea_cred_ml     decimal(20,4),
fc_lsg_sdo_medio_no_dispuesto_linea_cred_mo     decimal(20,4),
fc_lsg_sdo_no_dispuesto_linea_cred_ml           decimal(20,4),
fc_lsg_sdo_no_dispuesto_linea_cred_mo           decimal(20,4),
fc_lsg_porc_comision_no_dispuesto_linea_cred    decimal(8,5),
fc_lsg_porc_medio_dispuesto_mes                 decimal(8,5),
fc_lsg_sdo_medio_ant_rep_mo                     decimal(20,4),
fc_lsg_sdo_medio_pendiente_amrt_mo              decimal(20,4),
fc_lsg_sdo_ultima_revision_mo                   decimal(20,4),
int_lsg_ind_tasa_predef                         int,
fc_lsg_tasa_predef                              decimal(8,5),
fc_lsg_tasa_spread_predef                       decimal(8,5),
cod_lsg_responsable_tasa_predef                 string,
fc_lsg_valor_indice_reajuste_inicial            decimal(20,4),
fc_lsg_valor_indice_reajuste                    decimal(20,4),
dt_lsg_fecha_reestructuracion_cto               string,
dt_lsg_fecha_refinanciacion_cto                 string,
dt_lsg_fecha_novacion_cto                       string,
cod_lsg_ind_aval_ejecutado                      string,
cod_lsg_ind_deuda_publica                       string,
cod_lsg_ind_deuda_subordinada                   string,
cod_lsg_tipo_idf_emision                        string,
cod_lsg_idf_emision                             string,
cod_lsg_situacion_contable                      string,
fc_lsg_tasa_tae                                 decimal(8,5),
cod_lsg_ind_inversion                           string,
cod_lsg_proceso                                 string,
cod_lsg_sit_gestion                             string,
cod_lsg_sit_expediente                          string,
cod_lsg_finalidad                               string,
cod_lsg_minimod_pab                             string,
cod_lsg_destino_fondos                          string,
dt_lsg_fecha_cambio_condicion                   string,
cod_lsg_cartera_gestion                         string,
cod_lsg_complemento                             string,
fc_lsg_porc_util_ind                            decimal(8,5),
cod_lsg_tipo_centro                             string,
cod_lsg_tipo_centro_cont                        string,
cod_lsg_tipo_oficina_comercial                  string,
fc_lsg_porc_cupon                               decimal(8,5),
fc_lsg_tasa_com                                 decimal(8,5),
cod_lsg_cto_renovado                            string,
cod_lsg_canal                                   string,
int_lsg_frecuencia_carencia                     int,
cod_lsg_unidad_frecuencia_carencia              string,
cod_lsg_ori_ope                                 string,
dt_lsg_fecha_can_cto                            string,
int_lsg_num_cuota_cap_pac                       int,
int_lsg_frecuencia_pago_cap                     int,
cod_lsg_unidad_frecuencia_pago_cap              string,
cod_lsg_ind_excepcionado                        string,
int_lsg_plz_carencia                            int,
cod_lsg_sit_irr_cto                             string,
dt_lsg_fecha_carencia_cap                       string,
cod_lsg_ind_bookeo                              string,
fc_lsg_imp_inicial_ml                           decimal(20,4),
fc_lsg_imp_aval_cto                             decimal(20,4),
cod_lsg_ind_dano_crediticio                     string,
cod_lsg_ind_est_riesgo_cre                      string,
dt_lsg_fecha_carencia_int                       string,
cod_lsg_plan_gest_cre                           string,
cod_lsg_fideicomiso                             string,
cod_lsg_cartera_cre                             string,
cod_lsg_canal_contr                             string,
cod_lsg_entidad_orig                            string,
cod_lsg_tipo_centro_dc                          string,
cod_lsg_centro_dc                               string,
cod_lsg_tipo_centro_cart                        string,
cod_lsg_centro_cart                             string,
cod_lsg_tienda                                  string,
cod_lsg_blq                                     string,
cod_lsg_idf_contrato_origen                     string,
cod_lsg_ind_cobranza_judicial                   string,
dt_lsg_fecha_venc_int_cto                       string,
fc_lsg_imp_com_period                           decimal(20,4),
fc_lsg_imp_int_period_result                    decimal(20,4),
fc_lsg_imp_int_period_fuera_blce                decimal(20,4),
cod_lsg_tipo_colocacion                         string,
cod_lsg_tipo_movimiento                         string,
cod_lsg_idf_subcto_ods                          string,
dt_lsg_fecha_extrac                             string,
cod_lsg_ind_cto_subrrogacion                    string,
cod_lsg_tipo_fre_tasa_ref                       string,
cod_lsg_nat_act_suby                            string,
cod_lsg_cuenta_asc                              string,
cod_lsg_ent_cuenta_asc                          string,
int_lsg_plz_tas_ref                             int,
int_lsg_per_rev                                 int,
int_lsg_amt                                     int,
int_lsg_liq                                     int,
fc_lsg_porc_tipo_int                            decimal(8,5),
cod_lsg_por_dif                                 string,
fc_lsg_porc_tasa_ref                            decimal(8,5),
cod_lsg_por_tae_cto                             string,
fc_lsg_porc_int_demora                          decimal(8,5),
fc_lsg_imp_com_no_period                        decimal(20,4),
fc_lsg_imp_int_no_period                        decimal(20,4),
cod_lsg_cla_riesgo                              string,
cod_lsg_cla_riesgo_mat                          string,
cod_lsg_ciclo_prov                              string,
cod_lsg_ent_origen                              string,
cod_lsg_ind_riesgo_sub                          string,
cod_lsg_por_pon_cto                             string,
int_lsg_num_per_amt_rep_inc                     int,
fc_lsg_imp_pre_vivienda                         decimal(20,4),
cod_lsg_sucursal_cta_asociada                   string,
cod_lsg_est_ref                                 string,
cod_lsg_prelacion_deu_pub                       string,
cod_lsg_subtip_producto                         string,
cod_lsg_tip_producto                            string,
cod_lsg_unidad_frecuencia_tasa_ref              string,
dt_lsg_fecha_alta                               string,
dt_lsg_fecha_baja                               string,
int_lsg_num_fre_tas_ref                         int,
int_lsg_num_fila                                bigint,
flag_lsg_saldo_muerto                           int,
dt_lsg_fecha_ini_sdo_muerto                     string,
flag_lsg_audit_warning                          int,
ds_lsg_audit_dag                                string,
ds_lsg_audit_usuario_proceso                    string,
dt_lsg_audit_fecha_proceso                      string
)
PARTITIONED BY (
partition_date string)
STORED AS PARQUET
LOCATION
'${DATA_LAKE_SERVER}/santander/bi-corp/common/leasing/fact/stk_lsg_contratoactivo'
;