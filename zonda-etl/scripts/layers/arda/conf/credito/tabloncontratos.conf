tablonContratos {

  queries: {
    tableCtoActivoArf: """
        select idf_cto_ods, num_cuenta, cod_entidad, cod_producto, cod_subprodu, fec_alta_cto,
        fec_vencimiento, cod_divisa, cod_contenido, fec_data, idf_pers_ods, cod_centro,
        cod_centro_cont, cod_ofi_comercial, num_dia_demora, imp_ini_ml, imp_ini_mo, num_secuencia_cto,
        imp_lim_credito_ml, imp_disp_ml, plz_contractual, cod_sis_origen,
        'CTO_ACTIVO_ARF' as tabla_origen,
        cod_met_amrt, cod_tip_tasa, cod_uni_fre_pago_int, cod_uni_plz_amrt, tasa_int
        from ${database}.cto_activo_${dia_o_mes}_arf
        where data_date_part = '${loadDate}'
    """

    tableCtoActivoCco: """
        select idf_cto_ods, num_cuenta, cod_entidad, cod_producto, cod_subprodu, fec_alta_cto,
        fec_vencimiento, cod_divisa, cod_contenido, fec_data, idf_pers_ods, cod_centro,
        cod_centro_cont, cod_ofi_comercial, num_dia_demora, imp_ini_ml, imp_ini_mo, num_secuencia_cto,
        imp_lim_credito_ml, imp_disp_ml, plz_contractual, cod_sis_origen,
        'CTO_ACTIVO_CCO' as tabla_origen,
        cod_met_amrt, cod_tip_tasa, cod_uni_fre_pago_int, cod_uni_plz_amrt, tasa_int
        from ${database}.cto_activo_${dia_o_mes}_cco
        where data_date_part = '${loadDate}'
    """

    tableCtoActivoCre: """
        select idf_cto_ods, num_cuenta, cod_entidad, cod_producto, cod_subprodu, fec_alta_cto,
        fec_vencimiento, cod_divisa, cod_contenido, fec_data, idf_pers_ods, cod_centro,
        cod_centro_cont, cod_ofi_comercial, num_dia_demora, imp_ini_ml, imp_ini_mo, num_secuencia_cto,
        imp_lim_credito_ml, imp_disp_ml, plz_contractual, cod_sis_origen,
        'CTO_ACTIVO_CRE' as tabla_origen,
        cod_met_amrt, cod_tip_tasa, cod_uni_fre_pago_int, cod_uni_plz_amrt, tasa_int
        from ${database}.cto_activo_${dia_o_mes}_cre
        where data_date_part = '${loadDate}'
    """

    tableCtoActivoPre: """
        select idf_cto_ods, num_cuenta, cod_entidad, cod_producto, cod_subprodu, fec_alta_cto,
        fec_vencimiento, cod_divisa, cod_contenido, fec_data, idf_pers_ods, cod_centro,
        cod_centro_cont, cod_ofi_comercial, num_dia_demora, imp_ini_ml, imp_ini_mo, num_secuencia_cto,
        imp_lim_credito_ml, imp_disp_ml, plz_contractual, cod_sis_origen,
        'CTO_ACTIVO_PRE' as tabla_origen,
        cod_met_amrt, cod_tip_tasa, cod_uni_fre_pago_int, cod_uni_plz_amrt, tasa_int
        from ${database}.cto_activo_${dia_o_mes}_pre
        where data_date_part = '${loadDate}' and cod_producto NOT in ('45','46')
    """

    tableCtoActivoPreP45P46: """
      select
      concat_ws(',',collect_set(idf_cto_ods)) as idf_cto_ods,
      num_cuenta,
      cod_entidad,
      cod_producto,
      cod_subprodu,
      min(fec_alta_cto) as fec_alta_cto,
      max(fec_vencimiento) as fec_vencimiento,
      cod_divisa,
      max(cod_contenido) as cod_contenido,
      max(fec_data) as fec_data,
      max(idf_pers_ods) as idf_pers_ods,
      cod_centro,
      max(cod_centro_cont) as cod_centro_cont,
      max(cod_ofi_comercial) as cod_ofi_comercial,
      max(num_dia_demora) as num_dia_demora,
      max(imp_ini_ml) as imp_ini_ml,
      sum(imp_ini_mo) as imp_ini_mo,
      max(num_secuencia_cto) as num_secuencia_cto,
      0.0 as imp_lim_credito_ml,
      0.0 as imp_disp_ml,
      max(plz_contractual) as plz_contractual,
      max(cod_sis_origen) as cod_sis_origen,
      max(tabla_origen) as tabla_origen,
      max(cod_met_amrt) as cod_met_amrt,
      max(cod_tip_tasa) as cod_tip_tasa,
      max(cod_uni_fre_pago_int) as cod_uni_fre_pago_int,
      max(cod_uni_plz_amrt) as cod_uni_plz_amrt,
      sum(tasa_int_ponderada) as tasa_int
      from
      (
          select
              t1.*, t1.tasa_int*(t1.imp_ini_mo/t2.imp_ini_mo) as tasa_int_ponderada
          from
          (
              select idf_cto_ods, num_cuenta, cod_entidad, cod_producto, cod_subprodu, fec_alta_cto,
              fec_vencimiento, cod_divisa, cod_contenido, fec_data, idf_pers_ods, cod_centro,
              cod_centro_cont, cod_ofi_comercial, num_dia_demora, imp_ini_ml, imp_ini_mo, num_secuencia_cto,
              imp_lim_credito_ml, imp_disp_ml, plz_contractual, cod_sis_origen,
              'CTO_ACTIVO_PRE' as tabla_origen,
              cod_met_amrt, cod_tip_tasa, cod_uni_fre_pago_int, cod_uni_plz_amrt, tasa_int
              from ${database}.cto_activo_${dia_o_mes}_pre
              where data_date_part = '${loadDate}' and cod_producto in ('45','46')
          ) t1 left outer join
          (
              select cod_entidad,cod_centro,num_cuenta,cod_producto,cod_subprodu,cod_divisa, sum(imp_ini_mo) as imp_ini_mo
              from ${database}.cto_activo_${dia_o_mes}_pre
              where data_date_part = '${loadDate}' and cod_producto in ('45','46')
              group by cod_entidad,cod_centro,num_cuenta,cod_producto,cod_subprodu,cod_divisa
          ) t2 on
          t1.cod_entidad = t2.cod_entidad and
          t1.cod_centro = t2.cod_centro and
          t1.num_cuenta = t2.num_cuenta and
          t1.cod_producto = t2.cod_producto and
          t1.cod_subprodu = t2.cod_subprodu and
          t1.cod_divisa = t2.cod_divisa
      ) foo group by cod_entidad,cod_centro,num_cuenta,cod_producto,cod_subprodu,cod_divisa
    """

    tableCtoPasivoCta: """
        select idf_cto_ods, num_cuenta, cod_entidad, cod_producto, cod_subprodu, fec_alta_cto,
        fec_vencimiento, cod_divisa, cod_contenido, fec_data, idf_pers_ods, cod_centro,
        cod_centro_cont, cod_ofi_comercial, NULL as num_dia_demora, NULL as imp_ini_ml, imp_ini_mo, num_secuencia_cto,
        NULL as imp_lim_credito_ml, NULL as imp_disp_ml, plz_contractual, cod_sis_origen,
        'CTO_PASIVO_CTA' as tabla_origen,
        cod_met_amrt, cod_tip_tasa, cod_uni_fre_pago_int, NULL as cod_uni_plz_amrt, tasa_int
        from ${database}.cto_pasivo_${dia_o_mes}_cta
        where data_date_part = '${loadDate}'
    """

    tableCtoPasivoPlz: """
        select idf_cto_ods, num_cuenta, cod_entidad, cod_producto, cod_subprodu, fec_alta_cto,
        fec_vencimiento, cod_divisa, cod_contenido, fec_data, idf_pers_ods, cod_centro,
        cod_centro_cont, cod_ofi_comercial, NULL as num_dia_demora, NULL as imp_ini_ml, imp_ini_mo, num_secuencia_cto,
        NULL as imp_lim_credito_ml, NULL as imp_disp_ml, plz_contractual, cod_sis_origen,
        'CTO_PASIVO_PLZ' as tabla_origen,
        cod_met_amrt, cod_tip_tasa, cod_uni_fre_pago_int, NULL as cod_uni_plz_amrt, tasa_int
        from ${database}.cto_pasivo_${dia_o_mes}_plz
        where data_date_part = '${loadDate}'
    """

    tableCtoCtg: """
        select idf_cto_ods, num_cuenta, cod_entidad, cod_producto, cod_subprodu, fec_alta_cto,
        fec_vencimiento, cod_divisa, cod_contenido, fec_data, idf_pers_ods, cod_centro,
        cod_centro_cont, cod_ofi_comercial, num_dia_demora, NULL as imp_ini_ml, imp_ini_mo, num_secuencia_cto,
        imp_lim_credito_ml, imp_disp_ml, plz_contractual, cod_sis_origen,
        'CTO_CTG' as tabla_origen,
        cod_met_amrt, cod_tip_tasa, cod_uni_fre_pago_int, cod_uni_plz_amrt, tasa_int
        from ${database}.cto_ctg_${dia_o_mes}
        where data_date_part = '${loadDate}'
    """


    tableBalanceActivoDiaArrendamiento: """
        select idf_cto_ods, cod_cta_cont, imp_sdo_cont_ml, cod_tip_sdo, cod_est_sdo, cod_cls_sdo
        from ${database}.blce_act_dia_arf
        where data_date_part = '${loadDate}'
    """

    tableBalanceActivoDiaCarteraComercial: """
        select idf_cto_ods, cod_cta_cont, imp_sdo_cont_ml, cod_tip_sdo, cod_est_sdo, cod_cls_sdo
        from ${database}.blce_act_dia_cco
        where data_date_part = '${loadDate}'
    """

    tableBalanceActivoDiaCredito: """
        select idf_cto_ods, cod_cta_cont, imp_sdo_cont_ml, cod_tip_sdo, cod_est_sdo, cod_cls_sdo
        from ${database}.blce_act_dia_cre
        where data_date_part = '${loadDate}'
    """

    tableBalanceActivoDiaPrestamo: """
        select idf_cto_ods, cod_cta_cont, imp_sdo_cont_ml, cod_tip_sdo, cod_est_sdo, cod_cls_sdo
        from ${database}.blce_act_dia_pre
        where data_date_part = '${loadDate}'
    """

    tableBalancePasivoDiaCuenta: """
        select idf_cto_ods, cod_cta_cont, imp_sdo_cont_ml, cod_tip_sdo, cod_est_sdo, cod_cls_sdo
        from ${database}.blce_pas_dia_cta
        where data_date_part = '${loadDate}'
    """

    tableBalancePasivoDiaPlazo: """
        select idf_cto_ods, cod_cta_cont, imp_sdo_cont_ml, cod_tip_sdo, cod_est_sdo, cod_cls_sdo
        from ${database}.blce_pas_dia_plz
        where data_date_part = '${loadDate}'
    """

    tableBalanceContigenteDia: """
        select idf_cto_ods, cod_cta_cont, imp_sdo_cont_ml, cod_tip_sdo, cod_est_sdo, cod_cls_sdo
        from ${database}.blce_ctg_dia
        where data_date_part = '${loadDate}'
    """

    tableIngresosEgresosActivoDiaArrendamiento: """
        select idf_cto_ods, cod_cta_cont as cod_cta_cont_ie, imp_ie_ml
        from ${database}.ie_act_dia_arf
        where data_date_part = '${loadDate}'
    """

    tableIngresosEgresosActivoDiaCarteraComercial: """
        select idf_cto_ods, cod_cta_cont as cod_cta_cont_ie, imp_ie_ml
        from ${database}.ie_act_dia_cco
        where data_date_part = '${loadDate}'
    """

    tableIngresosEgresosActivoDiaCredito: """
        select idf_cto_ods, cod_cta_cont as cod_cta_cont_ie, imp_ie_ml
        from ${database}.ie_act_dia_cre
        where data_date_part = '${loadDate}'
    """

    tableIngresosEgresosActivoDiaPrestamo: """
        select idf_cto_ods, cod_cta_cont as cod_cta_cont_ie, imp_ie_ml
        from ${database}.ie_act_dia_pre
        where data_date_part = '${loadDate}'
    """

    tableIngresosEgresosPasivoDiaCuenta: """
        select idf_cto_ods, cod_cta_cont as cod_cta_cont_ie, imp_ie_ml
        from ${database}.ie_pas_dia_cta
        where data_date_part = '${loadDate}'
    """

    tableIngresosEgresosPasivoDiaPlazo: """
        select idf_cto_ods, cod_cta_cont as cod_cta_cont_ie, imp_ie_ml
        from ${database}.ie_pas_dia_plz
        where data_date_part = '${loadDate}'
    """

    tableIngresosEgresosContigenteDia: """
        select idf_cto_ods, cod_cta_cont as cod_cta_cont_ie, imp_ie_ml
        from ${database}.ie_ctg_dia
        where data_date_part = '${loadDate}'
    """





    tableSaldosConsolidados: """
        select numero_de_cuenta, fecha_movimiento, descripcion_de_cuenta, nuemro_cuenta_cargabal,
        numero_cuenta_bcra, saldo_fin_enero, saldo_fin_febrero, saldo_fin_marzo, saldo_fin_abril,
        saldo_fin_mayo, saldo_fin_junio, saldo_fin_julio, saldo_fin_agosto, saldo_fin_setiembre,
        saldo_fin_octubre, saldo_fin_noviembre, saldo_fin_diciembre
        from ${database}.saldos_consolidados
        where data_date_part = '${loadDate}'
    """


    tableInsolvenciaMes: """
        select idf_cto_ods, cod_tip_prov_mis, imp_sdo_mo, imp_sdo_ml, tip_sdo_insolvencia
        from ${database}.insolvencia_mes
        where data_date_part = '${loadDate}'
    """

    tablePersona: """
        select idf_pers_ods, num_persona, cod_tip_persona
        from ${database}.persona
        where data_date_part = '${loadDate}'
    """

    tablePersonas: """
        select num_persona, vinculacion_del_cliente
        from ${database}.personas
        where data_date_part = '${loadDate}'
    """

    tableSegmentoCliente: """
        select cod_entidad, num_persona, cod_segmento_calculado
        from ${database}.segmento_cliente
        where data_date_part = '${loadDate}'
    """

    tableClientesMora: """
        select numero_de_persona, marca_de_cliente, submarca_de_cliente
        from ${database}.clientes_en_mora
        where data_date_part = '${loadDate}'
    """

    tableUnidadControl: """
        select num_persona,division
        from ${database}.unidad_control
        where data_date_part = '${loadDate}'
    """


    tableClientes: """
        select num_persona,cod_subsegmento,cod_segmento_calculado
        from ${database}.clientes
        where data_date_part = '${loadDate}'
    """

    tableMorosidadYesterday: """
        select idf_cto_ods, ind_moroso as ind_moroso_yesterday, imp_sdo_cont_ml as imp_sdo_cont_ml_yesterday,
        imp_entrada_mora as imp_entrada_mora_yesterday,
        imp_salida_mora as imp_salida_mora_yesterday, imp_incremento_mora as imp_incremento_mora_yesterday,
        imp_decremento_mora as imp_decremento_mora_yesterday
        from ${database}.${table}
        where data_date_part = '${loadDateMinus1Day}' and cod_divisa = 'USD'
    """





    tableCarteraBasica: """
        select idf_cto_ods, cod_cartera_basica from ${database}.cartera_basica
    """


    tableMaestroAtributos: """
        select * from ${database}.maestro_atributos  where data_date_part = '${max_data_date_part}'
    """

    tableParameters: """
        select variable, value from ${stg_database}.parameters
    """

    tableCalendario: """
        select * from ${database}.calendario where data_date_part = ${max_data_date_part}
    """

    tableCotizacion: """
        SELECT cod_divisa, fec_cambio, imp_cambio_fijo/100 as imp_cambio_fijo
        FROM ${database}.cotizacion
        WHERE ind_divisa='D' AND ind_cotizacion='S' AND fec_cambio = '${fec_cambio}' AND
        data_date_part = '${loadDate}'
        UNION ALL
        SELECT 'ARS' as cod_divisa, '${fec_cambio}' as fec_cambio, 1.0 as imp_cambio_fijo
    """

    tableNormalizProductos: """
        select cod_producto,cod_subprodu,cod_aplicativo_fuente,
        cod_producto_operac, cod_subprodu_operac
        from ${database}.normaliz_productos where data_date_part = '${loadDate}'
    """

    tableRelacionContratoClienteOLD: """
        select rcc.cod_entidad, rcc.cod_centro, rcc.num_cuenta, rcc.cod_producto, rcc.cod_subprodu,
        rcc.num_persona, rcc.fec_alta as fec_alta_rel_cliente from ${database}.relacion_contrato_cliente rcc inner join
        (
         select cod_entidad, cod_centro,num_cuenta, cod_producto,cod_subprodu, min(ord_participacion) as min_ord_participacion,
         cal_participacion, cod_estado_relacion
         from ${database}.relacion_contrato_cliente where
         data_date_part = '${max_data_date_part}' and
         cod_producto <> '29'
         cal_participacion in ${P_s_Participacion_STR} and
         (cod_estado_relacion in ${P_s_Estado_Cliente_STR} or (cod_estado_relacion in ${P_s_Estado_cliente_baja_STR} and
          fec_baja > '${load_Date}'))
         group by cod_entidad, cod_centro,num_cuenta, cod_producto,cod_subprodu,cal_participacion,cod_estado_relacion
        ) mop on
        rcc.cod_entidad = mop.cod_entidad and
        rcc.cod_centro = mop.cod_centro and
        rcc.num_cuenta = mop.num_cuenta and
        rcc.cod_producto = mop.cod_producto and
        rcc.cod_subprodu = mop.cod_subprodu and
        rcc.ord_participacion = mop.min_ord_participacion and
        rcc.cal_participacion = mop.cal_participacion and
        rcc.cod_estado_relacion = mop.cod_estado_relacion and
        rcc.data_date_part = '${max_data_date_part}'
    """

    tableRelacionContratoCliente: """
      -- SPRINT 29: SE CAMBIA LA LÓGICA PARA EL PRODUCTO 29

      select cod_entidad, cod_centro, num_cuenta, cod_producto,cod_subprodu, num_persona, fec_alta_rel_cliente, fec_baja_rel_cliente, cod_estado_rel_cliente
      from (

           SELECT rcc.cod_entidad, rcc.cod_centro, rcc.num_cuenta, rcc.cod_producto, rcc.cod_subprodu,
             num_persona, fec_alta as fec_alta_rel_cliente, fec_baja as fec_baja_rel_cliente, cod_estado_relacion as cod_estado_rel_cliente,
             rank() over(partition by rcc.cod_entidad, rcc.cod_centro, rcc.num_cuenta, rcc.cod_producto, rcc.cod_subprodu order by data_date_part desc, ord_participacion asc, fec_baja desc) as rnk
           FROM ${database}.relacion_contrato_cliente rcc left join
           (
              SELECT cod_entidad, cod_centro, num_cuenta, cod_producto, cod_subprodu
              FROM
              (
                SELECT cod_entidad, cod_centro, num_cuenta, cod_producto, cod_subprodu
                FROM ${database}.contratos_adsf
                WHERE data_date_part = '${max_data_date_part_adsf}' and cod_producto <> '29'

                UNION ALL

                SELECT cod_entidad, cod_centro, num_cuenta, cod_producto, cod_subprodu
                FROM ${database}.contratos_deudores_adic
                WHERE data_date_part = '${max_data_date_part_prest}' and cod_producto <> '29'
              ) adsf_adic
              GROUP BY cod_entidad, cod_centro, num_cuenta, cod_producto, cod_subprodu
           ) ca on ca.cod_entidad = rcc.cod_entidad and ca.cod_centro = rcc.cod_centro and
                ca.num_cuenta = rcc.num_cuenta and ca.cod_producto = rcc.cod_producto and
                ca.cod_subprodu = rcc.cod_subprodu
           where data_date_part >= '${loadDate}' and data_date_part <= '${max_data_date_part}' and
           rcc.cod_producto <> '29' and
           cal_participacion in ${P_s_Participacion_STR} and
           (cod_estado_relacion in ${P_s_Estado_Cliente_STR} or (cod_estado_relacion in ${P_s_Estado_cliente_baja_STR} and (ca.cod_entidad is not null or fec_baja ${SIGN_FEC_BAJA} '${load_Date}'))) and
           fec_alta <= concat(substr('${load_Date}',1,8),'99') and
           fec_alta <> '0'
      ) foo
      where rnk = 1

      UNION ALL

      select cod_entidad, cod_centro, num_cuenta, cod_producto, cod_subprodu, num_persona, fec_alta_rel_cliente, fec_baja_rel_cliente, cod_estado_rel_cliente
      from(
          select cod_entidad, cod_centro,num_cuenta, cod_producto,cod_subprodu,
          num_persona, fec_alta_rel_cliente, fec_baja as fec_baja_rel_cliente, cod_estado_relacion as cod_estado_rel_cliente,
          rank() over(partition by cod_entidad, cod_centro,num_cuenta, cod_producto,cod_subprodu order by data_date_part desc, ord_participacion asc, fec_baja desc) as rnk
          from
          (
             select rcc.cod_entidad,rcc.cod_centro,rcc.num_cuenta,rcc.cod_producto,rcc.cod_subprodu,
             rcc.num_persona,rcc.fec_alta_rel_cliente,
             rcc.cod_estado_relacion,rcc.cal_participacion,rcc.fec_baja,rcc.ord_participacion,rcc.data_date_part,
             arf.num_dia_demora, ca.cod_entidad as entidad_adsf
             from
             (
               select cod_entidad,cod_centro,num_cuenta,cod_producto,cod_subprodu,
               num_dia_demora
               from ${database}.CTO_ACTIVO_${dia_o_mes}_ARF
               where data_date_part = '${loadDate}' and cod_producto = '29'
             ) arf inner join
             (
               select cod_entidad,cod_centro,num_cuenta,cod_producto,cod_subprodu,
               num_persona, fec_alta as fec_alta_rel_cliente,
               cod_estado_relacion, cal_participacion, fec_baja, ord_participacion, data_date_part
               from ${database}.relacion_contrato_cliente where
               data_date_part >= '${loadDate}' and data_date_part <= '${max_data_date_part}' and cod_producto = '29'
             ) rcc on
             arf.cod_entidad = rcc.cod_entidad and
             arf.cod_centro = rcc.cod_centro and
             arf.num_cuenta = rcc.num_cuenta and
             arf.cod_producto = rcc.cod_producto and
             arf.cod_subprodu = rcc.cod_subprodu
             left join
             (
              SELECT cod_entidad, cod_centro, num_cuenta, cod_producto, cod_subprodu
              FROM
              (
                SELECT cod_entidad, cod_centro, num_cuenta, cod_producto, cod_subprodu
                FROM ${database}.contratos_adsf
                WHERE data_date_part = '${max_data_date_part_adsf}' and cod_producto = '29'

                UNION ALL

                SELECT cod_entidad, cod_centro, num_cuenta, cod_producto, cod_subprodu
                FROM ${database}.contratos_deudores_adic
                WHERE data_date_part = '${max_data_date_part_prest}' and cod_producto = '29'
              ) adsf_adic
              GROUP BY cod_entidad, cod_centro, num_cuenta, cod_producto, cod_subprodu
             ) ca on ca.cod_entidad = rcc.cod_entidad and ca.cod_centro = rcc.cod_centro and ca.num_cuenta = rcc.num_cuenta and
                    ca.cod_producto = rcc.cod_producto
         ) rccP29
         where
         cal_participacion in ${P_s_Participacion_STR} and
         (cod_estado_relacion in ${P_s_Estado_Cliente_STR} or (cod_estado_relacion in ${P_s_Estado_cliente_baja_STR} and (entidad_adsf is not null or fec_baja ${SIGN_FEC_BAJA} '${load_Date}')) or (cod_estado_relacion in ${P_s_Estado_cliente_baja_STR} and num_dia_demora > 90)) and
         fec_alta_rel_cliente <= concat(substr('${load_Date}',1,8),'99') and
         fec_alta_rel_cliente <> '0'

      ) foo
      where rnk = 1
    """

    tableRelacionContratoClienteCuentasRecaudadorasOLD: """
        select rcc.cod_entidad, rcc.cod_centro, rcc.num_cuenta, rcc.cod_producto, rcc.cod_subprodu as cod_subprodu_recaudadora
        from ${database}.relacion_contrato_cliente rcc inner join
        (
         select cod_entidad, cod_centro,num_cuenta, cod_producto,cod_subprodu, min(ord_participacion) as min_ord_participacion,
         cal_participacion, cod_estado_relacion
         from ${database}.relacion_contrato_cliente where
         data_date_part = '${max_data_date_part}' and
         cal_participacion in ${P_s_Participacion_STR} and
         (cod_estado_relacion in ${P_s_Estado_Cliente_STR} or (cod_estado_relacion in ${P_s_Estado_cliente_baja_STR}
          and fec_baja > '${load_Date}')) and cod_producto in ${P_s_Productos_Cuentas_STR}
         group by cod_entidad, cod_centro,num_cuenta, cod_producto,cod_subprodu,cal_participacion,cod_estado_relacion
        ) mop on
        rcc.cod_entidad = mop.cod_entidad and
        rcc.cod_centro = mop.cod_centro and
        rcc.num_cuenta = mop.num_cuenta and
        rcc.cod_producto = mop.cod_producto and
        rcc.cod_subprodu = mop.cod_subprodu and
        rcc.ord_participacion = mop.min_ord_participacion and
        rcc.cal_participacion = mop.cal_participacion and
        rcc.cod_estado_relacion = mop.cod_estado_relacion and
        rcc.data_date_part = '${max_data_date_part}'
    """

    tableRelacionContratoClienteCuentasRecaudadoras: """
      select cod_entidad, cod_centro, num_cuenta, cod_producto, cod_subprodu as cod_subprodu_recaudadora
      from (

           select cod_entidad, cod_centro, num_cuenta, cod_producto,cod_subprodu,
           rank() over(partition by cod_entidad, cod_centro, num_cuenta, cod_producto, cod_subprodu order by data_date_part desc, ord_participacion asc) as rnk

           from ${database}.relacion_contrato_cliente
           where data_date_part >= '${loadDate}' and data_date_part <= '${max_data_date_part}' and
           cod_producto in ${P_s_Productos_Cuentas_STR} and
           cal_participacion in ${P_s_Participacion_STR} and
           fec_alta <= concat(substr('${load_Date}',1,8),'99') and
           fec_alta <> '0'

      ) foo
      where rnk = 1
      group by cod_entidad, cod_centro, num_cuenta, cod_producto, cod_subprodu
    """

    tableContratoGarra: """
       select concat(cod_entidad,'_',cod_centro,'_',num_cuenta,'_',cod_producto,'_',cod_subprodu,'_',cod_divisa) as
       idf_cto_supra, cod_marca, cod_submarca, imp_riesgo_divisa_local_del_contrato as imp_riesgo,
       fec_inicio_situacion_irregular as fec_sit_irregular, dias_de_impago, fec_marca_submarca, cod_atribuido_a_segmento_especial,
       cod_tip_reestruct as cod_reesctr_garra
       from ${database}.contratos_garra where data_date_part = '${loadDate}'
    """

    tableContratosAdsf: """
        select idf_cto_supra, situacion_bcra, sum(imp_prevision) as imp_prevision, sum(imp_deuda) as imp_deuda from
        (
        select concat(cod_entidad,'_',cod_centro,'_',num_cuenta,'_',cod_producto,'_',cod_subprodu,'_',cod_divisa) as
        idf_cto_supra, situacion_bcra, imp_prevision, imp_deuda
        from ${database}.contratos_adsf where data_date_part = '${max_data_date_part}'
        ) foo
        group by idf_cto_supra, situacion_bcra
    """

    tablePrest: """
      select
      concat_ws("_", cod_entidad,  cod_centro,  num_cuenta,  cod_producto,  cod_subprodu, cod_divisa) as idf_cto_supra_prest,
      sum(imp_prev) as imp_prevision_prest, sum(imp_deuda) as imp_deuda_prest
      from ${database}.contratos_deudores_adic
      where data_date_part = '${max_data_date_part}'
      group by
      cod_entidad,  cod_centro,  num_cuenta,  cod_producto,  cod_subprodu, cod_divisa
    """

    tableGestionMoraTardia: """
      select concat(cod_entidad,'_',cod_centro,'_',num_cuenta,'_',cod_producto,'_',cod_subprodu,'_',cod_divisa) as
      idf_cto_supra, cod_estado, imp_tot_ajuste_capital_desde_ug as imp_tot_ajuste_capital,
      imp_total_impuesto, imp_total_interes, imp_interes_documentado, imp_total_capital, fec_castigo,
      fec_abandono_con_seguimiento, fec_abandono_total
      from ${database}.gestion_de_mora_tardia where
      data_date_part = '${loadDate}'
    """

    tableGestionMoraTardiaCodEstado30: """
      select concat(cod_entidad,'_',cod_centro,'_',num_cuenta,'_',cod_producto,'_',cod_subprodu,'_',cod_divisa) as idf_cto_supra,
      cod_entidad,
      cod_centro,
      num_cuenta,
      cod_producto,
      cod_subprodu as cod_subprodu_altair,
      cod_divisa,
      num_persona,
      '${loadDate}' as fec_data
      from ${database}.gestion_de_mora_tardia where cod_estado = '30' and data_date_part = '${loadDate}'
    """

    tableMoriaAbandonos: """
    select
    gdmt.*,
    nvl(garra.cod_marca,'FA') as cod_marca,
    nvl(garra.cod_submarca,'FA') as cod_submarca,
    garra.imp_riesgo,
    garra.fec_sit_irregular,
    garra.dias_de_impago,
    garra.fec_marca_submarca,
    producto.ind_producto_riesgo
    from
    (
          select concat(cod_entidad,'_',cod_centro,'_',num_cuenta,'_',cod_producto,'_',cod_subprodu,'_',cod_divisa) as
          idf_cto_supra,
          cod_estado,
          imp_tot_ajuste_capital_desde_ug as imp_tot_ajuste_capital,
          imp_total_impuesto,
          imp_total_interes,
          imp_interes_documentado,
          imp_total_capital,
          fec_castigo,
          fec_abandono_con_seguimiento,
          fec_abandono_total,
          cod_entidad, cod_centro, num_cuenta, cod_producto, cod_subprodu as cod_subprodu_altair, cod_divisa, num_persona,
          '${loadDate}' as fec_data
          from ${database}.gestion_de_mora_tardia where cod_estado = '30' and data_date_part = '${loadDate}'
    ) gdmt left outer join
    (
           select concat(cod_entidad,'_',cod_centro,'_',num_cuenta,'_',cod_producto,'_',cod_subprodu,'_',cod_divisa) as
           idf_cto_supra, cod_marca, cod_submarca, imp_riesgo_divisa_local_del_contrato as imp_riesgo,
           fec_inicio_situacion_irregular as fec_sit_irregular, dias_de_impago, fec_marca_submarca
           from ${database}.contratos_garra where data_date_part = '${loadDate}'
    ) garra on
    gdmt.idf_cto_supra = garra.idf_cto_supra left outer join
    (
           select cod_entidad, cod_producto, ind_producto_de_riesgo as ind_producto_riesgo
           from ${database}.producto where data_date_part = '${loadDate}'
    ) producto on
    gdmt.cod_entidad = producto.cod_entidad and
    gdmt.cod_producto = producto.cod_producto
    """

    tableGestionGastosHonorarios: """
     select idf_cto_supra,
         sum(imp_gastos_moria) as imp_gastos_moria,
         sum(imp_total_canc_contrato) as imp_total_canc_contrato,
         sum(imp_total_contable) as imp_total_contable,
         sum(imp_interes_cps) as imp_interes_cps,
         sum(imp_interes_mor) as imp_interes_mor
     from
     (
      select concat(cod_entidad,'_',cod_centro,'_',num_cuenta,'_',cod_producto,'_',cod_subprodu,'_',cod_divisa)
      as idf_cto_supra,
      imp_impuesto_perc_total as imp_gastos_moria,
      imp_canc_cto as imp_total_canc_contrato,
      imp_total_contable,
      imp_imperc_int_cps as imp_interes_cps,
      imp_imperc_int_mor as imp_interes_mor
      from ${database}.gestion_de_gastos_honorarios where data_date_part = '${loadDate}'
     ) foo
     group by idf_cto_supra
    """

    // SPRINT 26: Sólo se han de traer las garantías activas
    tableGarantia: """
        select concat_ws('_',gar.cod_entidad_rgo,gar.cod_centro,gar.num_cuenta,gar.cod_producto,gar.cod_subprodu,gar.cod_divisa_rgo) as idf_cto_supra,
        gar.imp_escritura, gar.cod_divisa_escritura,
        gar.num_bien, gar.cod_tip_propieda_hip, gar.cod_cls_garantia
        from ${database}.garantia gar
        inner join
        (
          select num_garantia
          from ${database}.garantias_activas
          where data_date_part = '${loadDate}'
          group by num_garantia
        ) gar_act on
        gar.num_garantia = gar_act.num_garantia and
        gar.data_date_part = '${loadDate}'
    """

    // SPRINT 26: Sólo se han de traer las garantías activas
    tableGarantiaImpMaxCobertura: """
        select concat_ws('_',gar.cod_entidad_rgo,gar.cod_centro,gar.num_cuenta,gar.cod_producto,gar.cod_subprodu,gar.cod_divisa_rgo) as idf_cto_supra,
        gar.cod_divisa, gar.imp_limite * (gar.porc_cobertura_rgo/100.0) as imp_limite
        from ${database}.garantia gar
        inner join
        (
          select num_garantia
          from ${database}.garantias_activas
          where data_date_part = '${loadDate}'
          group by num_garantia
        ) gar_act on
        gar.num_garantia = gar_act.num_garantia and
        gar.data_date_part = '${loadDate}'
    """

    tableBienGarantia: """
        select imp_tas_orig, imp_ult, cod_bien, num_bien, cod_divisa
        from ${database}.bien_garantia
        where data_date_part = '${loadDate}'
    """

    tableTipoBienRaiz: """
        select codigo, ponderacion from ${database}.tipo_bien_raiz
        where data_date_part = '${max_data_date_part}'
    """

    tableMarcaComite: """
        select num_persona, cod_marca_subjetiva, cod_submarca_subjetiva, fec_revision
        from ${database}.marca_comite
        where data_date_part = '${max_data_date_part}' and '${data_date_part_guiones}' <= fec_revision
    """

    tableProducto: """
        select cod_entidad, cod_producto, ind_producto_de_riesgo as ind_producto_riesgo
        from ${database}.producto where data_date_part = '${loadDate}'
    """


    tableImportes: """
     select idf_cto_supra , max(situacion_bcra) as situacion_bcra , sum(imp_deuda) as imp_deuda , sum(imp_prevision) as imp_prevision ,
        collect_set(concepto_1)[0] as imp_adsf_cap,
        collect_set(concepto_2)[0] as imp_adsf_int_dev,
        collect_set(concepto_3)[0] as imp_adsf_int_doc,
        collect_set(concepto_4)[0] as imp_adsf_iva_pend_cob,
        collect_set(concepto_5)[0] as imp_adsf_seg,
        collect_set(concepto_6)[0] as imp_adsf_acdo_no_utlz,
        collect_set(concepto_7)[0] as imp_adsf_ajustes,
        max(cod_destino_de_los_fondos) as cod_destino_fondos
     from (
          select idf_cto_supra, imp_deuda , imp_prevision , situacion_bcra, cod_destino_de_los_fondos,
           case when cod_concepto = '01' then imp_deuda end as concepto_1,
           case when cod_concepto = '02' then imp_deuda end as concepto_2,
           case when cod_concepto = '03' then imp_deuda end as concepto_3,
           case when cod_concepto = '04' then imp_deuda end as concepto_4,
           case when cod_concepto = '05' then imp_deuda end as concepto_5,
           case when cod_concepto = '06' then imp_deuda end as concepto_6,
           case when cod_concepto = '07' then imp_deuda end as concepto_7
          from (
              select idf_cto_supra, cod_concepto,
              max(situacion_bcra) as situacion_bcra , sum(imp_deuda) as imp_deuda , sum(imp_prevision) as imp_prevision,
              max(cod_destino_de_los_fondos) as cod_destino_de_los_fondos
              from (
                  select
                  concat_ws("_", cod_entidad,  cod_centro,  num_cuenta,  cod_producto,  cod_subprodu, cod_divisa) as idf_cto_supra
                  ,cod_concepto, imp_deuda, imp_prevision , situacion_bcra, cod_destino_de_los_fondos
                  from ${database}.contratos_adsf
                  where data_date_part = '${max_data_date_part_adsf}'

                   union all

                  select
                    concat_ws("_", cod_entidad,  cod_centro,  num_cuenta,  cod_producto,  cod_subprodu, cod_divisa) as idf_cto_supra
                    ,cod_concepto, imp_deuda, imp_prev as imp_prevision, null as situacion_bcra, null as cod_destino_de_los_fondos
                  from ${database}.contratos_deudores_adic
                  where data_date_part = '${max_data_date_part_prest}'
              ) adsf_adic
              group by idf_cto_supra, cod_concepto
          ) total_not_grouped
     ) total_grouped
     group by idf_cto_supra
    """

    tableContratosRefinanciados: """
        select idf_cto_supra, max(cod_reesctr) as cod_reesctr, '1' as ind_refinanciacion from
        (
           select concat(cod_entidad,'_',cod_centro,'_',num_cuenta,'_',cod_producto,'_',cod_subprodu,'_',cod_divisa) as
           idf_cto_supra, cod_reesctr as cod_reesctr
           from ${database}.contratos_refinanciados where cod_producto in ${P_s_Prestamos_Refinanciacion_STR}
           and data_date_part = '${loadDate}'
        ) foo
        group by idf_cto_supra
    """

    tableMarcaRefinanciados: """
        select concat(cod_entidad,'_',cod_centro,'_',num_cuenta,'_',cod_producto,'_',cod_subprodu,'_',cod_divisa) as idf_cto_supra,
        cod_marca as cod_marca_refinanciado, cod_submarca as cod_submarca_refinanciado
        from ${database}.marca_refinanciados
        where data_date_part = '${max_data_date_part}'
    """

    tableMarcaContingente: """
        select cod_producto, cod_subprodu as cod_subprodu_altair, ind_contingente
        from ${database}.marca_contingente
        where data_date_part = '${max_data_date_part}'
    """

    tablePerfilesBP: """
        select concat(cod_entidad,'_',cod_centro,'_',num_cuenta,'_',cod_producto,'_',cod_subprodu,'_',cod_divisa) as idf_cto_supra,
        cod_perfil as cod_perfil_inversion,

        case when cod_perfil = 0 then '1' else '0' end as ind_inversion_sin_perfilar,
        case when cod_perfil = 2 then '1' else '0' end as ind_inversion_conservador,
        case when cod_perfil = 3 then '1' else '0' end as ind_inversion_moderado,
        case when cod_perfil in (1,4) then '1' else '0' end as ind_inversion_arriesgado

        from ${database}.perfilesbp
        where data_date_part = '${max_data_date_part}'
    """

    tableContratos: """
      select * from ${database}.${table} where data_date_part = '${loadDate}'
    """

    tableCalendarioLabAnterior: """
        select laborable_anterior_yyyymmdd
        from ${database}.calendario where data_date_part = '${max_data_date_part}' and fec_yyyymmdd = '${loadDate}'
    """

    tableCalendarioUltLabMesAnterior: """
        select laborable_mes_anterior_yyyymmdd
        from ${database}.calendario where data_date_part = '${max_data_date_part}' and fec_yyyymmdd = '${loadDate}'
    """

    tableDemoraLabAnterior: """
      select hoy.idf_cto_supra, ayer.ind_moroso_anterior, ayer.imp_riesgo_anterior
      from
      (
       select idf_cto_supra, ind_moroso as ind_moroso_anterior, imp_riesgo as imp_riesgo_anterior
       from ${database}.${table} where data_date_part = '${laborableAnterior}'
      ) ayer inner join
      (
       select idf_cto_supra, idf_cto_supra_traspasado
       from ${database}.${table} where data_date_part = '${loadDate}'
      ) hoy on
      ayer.idf_cto_supra = hoy.${idf_cto_supra_OR_idf_cto_supra_traspasado}
    """

    tableDemoraLabAnteriorGUA: """
       select idf_cto_supra_original, ind_moroso as ind_moroso_anterior, imp_riesgo as imp_riesgo_anterior
       from ${database}.${table} where data_date_part = '${laborableAnterior}'
    """

    tableModellicaUltLabMesAnterior: """
    select hoy.idf_cto_supra, anterior.provision_amount as provision_amount_anterior,
    anterior.pd_lt_ifrs9_temporal as pd_lt_ifrs9_temporal_anterior,
    anterior.final_stage as final_stage_anterior
    from
    (
      select idf_cto_supra, provision_amount, pd_lt_ifrs9_temporal, final_stage
      from ${database}.${table} where data_date_part = '${ultLaborableMesAnterior}'
    ) anterior inner join
    (
      select idf_cto_supra,idf_cto_supra_traspasado
      from ${database}.${table} where data_date_part = '${loadDate}'
    ) hoy on
    anterior.idf_cto_supra = hoy.${idf_cto_supra_OR_idf_cto_supra_traspasado}
    """

    tableModellicaUltLabMesAnteriorGUA: """
      select idf_cto_supra_original, provision_amount as provision_amount_anterior,
      pd_lt_ifrs9_temporal as pd_lt_ifrs9_temporal_anterior, final_stage as final_stage_anterior
      from ${database}.${table} where data_date_part = '${ultLaborableMesAnterior}'
    """

    tablePDOriginacion: """
    select hoy.idf_cto_supra, pdorig.pd_lt_ifrs9_temporal as pd_lt_ifrs9_temporal_anterior, pdorig.provision_amount as provision_amount_anterior, pdorig.final_stage as final_stage_anterior
    from
    (
      select concat(cod_entidad,'_',cod_centro,'_',num_cuenta,'_',cod_producto,'_',cod_subprodu,'_',cod_divisa)
      as idf_cto_supra, pd_originacion as pd_lt_ifrs9_temporal, null as provision_amount, null as final_stage
      from ${database}.pd_originacion
      where data_date_part = '${max_data_date_part}'
    ) pdorig inner join
    (
      select idf_cto_supra, idf_cto_supra_traspasado
      from ${database}.${table} where data_date_part = '${loadDate}'
    ) hoy on
    pdorig.idf_cto_supra = hoy.${idf_cto_supra_OR_idf_cto_supra_traspasado}
    """

    tablePDOriginacionGUA: """
    select idf_cto_supra_original, pd_lt_ifrs9_temporal as pd_lt_ifrs9_temporal_anterior, provision_amount as provision_amount_anterior, final_stage as final_stage_anterior
    from
    (
      select concat(cod_entidad,'_',cod_centro,'_',num_cuenta,'_',cod_producto,'_',cod_subprodu,'_',cod_divisa)
      as idf_cto_supra_original, pd_originacion as pd_lt_ifrs9_temporal, null as provision_amount, null as final_stage
      from ${database}.pd_originacion
      where data_date_part = '${max_data_date_part}'
    ) pdorig
    """

    tableArgStaging: """
      select stg.idf_cto_ifrs, stg.provision_amount, stg.final_stage
      from ${ifrs9_database}.${P_s_Modellica_Modellica_Staging_Tablename} stg inner join

      (select max(data_timestamp_part) as tstamp from ${ifrs9_database}.${P_s_Modellica_Modellica_Staging_Tablename}
       where bucket_part in ${P_s_Modellica_Bucket_Part_STR} and fin_part in ${P_s_Modellica_Fin_Part_STR}
       and data_date_part = '${loadDate}') foo

       where stg.data_timestamp_part = foo.tstamp and
             stg.bucket_part in ${P_s_Modellica_Bucket_Part_STR} and
             stg.fin_part in ${P_s_Modellica_Fin_Part_STR} and
             stg.data_date_part = '${loadDate}'
    """

    tableArgExpectedLoss: """
      select loss.idf_cto_ifrs, loss.portfolio_ifrs9, loss.pd_lt_ifrs9_temporal as pd_lt_ifrs9_temporal_post_mod
      from ${ifrs9_database}.${P_s_Modellica_Modellica_ExpectedLoss_Tablename} loss inner join

      (select max(data_timestamp_part) as tstamp from ${ifrs9_database}.${P_s_Modellica_Modellica_ExpectedLoss_Tablename}
       where bucket_part in ${P_s_Modellica_Bucket_Part_STR} and fin_part in ${P_s_Modellica_Fin_Part_STR}
       and data_date_part = '${loadDate}') foo

       where loss.data_timestamp_part = foo.tstamp and
             loss.bucket_part in ${P_s_Modellica_Bucket_Part_STR} and
             loss.fin_part in ${P_s_Modellica_Fin_Part_STR} and
             loss.data_date_part = '${loadDate}'
    """

    tableSubproducto: """
      select distinct(cod_subprodu) as cod_subprodu, '1' as subproducto_en_tabla_subproducto
      from ${database}.subproducto where data_date_part = '${loadDate}'
    """

    tableMesesInactividadTarjeta: """
select idf_cto_supra,
       CASE
          WHEN mes_inact_tdc IS null THEN 0
          WHEN (max_imp_riesgo = 0) and (min_imp_riesgo = 0) THEN mes_inact_tdc + 1
          ELSE 0
       END AS mes_inact_tdc
FROM
(
      select
             idf_cto_supra, max(max_imp_riesgo) as max_imp_riesgo, min(min_imp_riesgo) as min_imp_riesgo, max(mes_inact_tdc) as mes_inact_tdc
      from
      (
            -- CONTRATOS QUE NO HAN CAMBIADO
            select hoy.idf_cto_supra, mes_pasado.max_imp_riesgo, mes_pasado.min_imp_riesgo, mes_pasado.mes_inact_tdc
            from
            (
                  select idf_cto_supra, max(imp_riesgo) as max_imp_riesgo, min(imp_riesgo) as min_imp_riesgo,
                  max(mes_inact_tdc) as mes_inact_tdc
                  from ${database}.${table}
                  where data_date_part >= '${startDate}' and data_date_part <= '${endDate}' and
                  cod_producto in ${P_s_Tarjetas_STR}
                  group by idf_cto_supra
            ) mes_pasado inner join
            (
             select idf_cto_supra
             from ${database}.${table} where data_date_part = '${loadDate}'
            ) hoy on
            mes_pasado.idf_cto_supra = hoy.idf_cto_supra

            union all

            -- LOS CONTRATOS QUE HAN CAMBIADO DE NOMBRE SE CRUZAN POR SU idf_cto_supra_traspasado
            select hoy.idf_cto_supra, mes_pasado.max_imp_riesgo, mes_pasado.min_imp_riesgo, mes_pasado.mes_inact_tdc
            from
            (
                  select idf_cto_supra, max(imp_riesgo) as max_imp_riesgo, min(imp_riesgo) as min_imp_riesgo,
                  max(mes_inact_tdc) as mes_inact_tdc
                  from ${database}.${table}
                  where data_date_part >= '${startDate}' and data_date_part <= '${endDate}' and
                  cod_producto in ${P_s_Tarjetas_STR}
                  group by idf_cto_supra
            ) mes_pasado inner join
            (
             select idf_cto_supra, idf_cto_supra_traspasado
             from ${database}.${table} where data_date_part = '${loadDate}'
            ) hoy on
            mes_pasado.idf_cto_supra = hoy.idf_cto_supra_traspasado
      ) foo group by idf_cto_supra
) foo2
    """

    tableMesesInactividadTarjetaGUA: """
    select idf_cto_supra_original,
           CASE
              WHEN mes_inact_tdc IS null THEN 0
              WHEN (max_imp_riesgo = 0) and (min_imp_riesgo = 0) THEN mes_inact_tdc + 1
              ELSE 0
           END AS mes_inact_tdc
    FROM
    (
                  select idf_cto_supra_original, max(imp_riesgo) as max_imp_riesgo, min(imp_riesgo) as min_imp_riesgo,
                  max(mes_inact_tdc) as mes_inact_tdc
                  from ${database}.${table}
                  where data_date_part >= '${startDate}' and data_date_part <= '${endDate}' and
                  cod_producto in ${P_s_Tarjetas_STR}
                  group by idf_cto_supra_original

    ) foo
    """

    tableCtoActivoCreReq3Caso1: """
      select ctos.idf_cto_supra, cre.imp_lim_credito_ml as imp_lim_credito_ml_req_3_caso_1, cre.tasa_int as tasa_int_req_3_caso_1,
        '1' as caso_1
        from(
        select idf_cto_supra, concat_ws('_',cod_entidad,cod_centro,concat('0',cod_producto,substr(num_cuenta,4,9)),
        cod_producto,cod_subprodu_altair,cod_divisa) as idf_cto_supra_req_3
        from ${database}.${table}
        where data_date_part = '${loadDate}' and
        cod_producto in ${P_s_Productos_Cuentas_STR} and
        num_cuenta like ('000%')
      ) ctos

      inner join

      (select concat_ws('_',cod_entidad,cod_centro,num_cuenta,cod_producto,cod_subprodu,cod_divisa) as idf_cto_supra_cre,
        imp_lim_credito_ml, tasa_int
        from ${database}.CTO_ACTIVO_${dia_o_mes}_CRE
        where data_date_part = '${loadDate}'  and
        cod_producto in ${P_s_Productos_Cuentas_STR} and
        fec_alta_cto = 0 and
        fec_vencimiento = 0
      ) cre on
      ctos.idf_cto_supra_req_3 = cre.idf_cto_supra_cre
    """

    tableCtoActivoCreReq3Caso2: """
      select max(ctos.idf_cto_supra) as idf_cto_supra,
      sum(cre.imp_lim_credito_ml) as imp_lim_credito_ml_req_3_caso_2, avg(cre.tasa_int) as tasa_int_req_3_caso_2,
       '1' as caso_2
       from(
        select idf_cto_supra,concat_ws('_',cod_entidad,cod_centro,concat('0',cod_producto,substr(num_cuenta,4,9)),
        cod_producto,cod_subprodu_altair,cod_divisa) as idf_cto_supra_req_3
        from ${database}.${table}
        where data_date_part = '${loadDate}' and
        cod_producto in ${P_s_Productos_Cuentas_STR} and
        num_cuenta like ('000%')
      ) ctos

      inner join

      (select concat_ws('_',cod_entidad,cod_centro,num_cuenta,cod_producto,cod_subprodu,cod_divisa) as idf_cto_supra_cre,
        imp_lim_credito_ml, tasa_int
        from ${database}.CTO_ACTIVO_${dia_o_mes}_CRE
        where data_date_part = '${loadDate}'  and
        cod_producto in ${P_s_Productos_Cuentas_STR} and
        fec_alta_cto != 0 and
        fec_vencimiento != 0 and
        data_date_part >= cast(fec_alta_cto as String) and
        data_date_part <= cast(fec_vencimiento as String)

      ) cre on
      ctos.idf_cto_supra_req_3 = cre.idf_cto_supra_cre
      group by ctos.idf_cto_supra_req_3
    """

    tableMaestroCuentasAuxiliarReq4: """
    select ctos.cod_entidad,ctos.cod_centro,ctos.num_cuenta,ctos.cod_divisa,mcya.imp_limite as imp_limite_req4
       from(
        select idf_cto_supra,concat_ws('_',cod_entidad,cod_centro,concat('0',cod_producto,substr(num_cuenta,4,9)),
        cod_producto,cod_subprodu_altair,cod_divisa) as idf_cto_supra_req4,
        cod_entidad,cod_centro,num_cuenta,concat('0',cod_producto,substr(num_cuenta,4,9)) as num_cuenta_req4,cod_producto,cod_subprodu_altair,cod_divisa
        from ${database}.${table}
        where data_date_part = '${loadDate}' and
        cod_producto in ${P_s_Productos_Cuentas_STR} and
        num_cuenta like ('000%')
      ) ctos

      inner join

      (select cod_entidad, cod_centro, num_cuenta, cod_divisa, imp_limite
        from ${database}.maestra_cuentas_y_auxiliar
        where data_date_part = '${loadDate}'  and
        data_date_part <= concat(substr(fec_vencimiento,1,4),substr(fec_vencimiento,6,2),substr(fec_vencimiento,9,2) )

      ) mcya on
      ctos.cod_entidad = mcya.cod_entidad and
      ctos.cod_centro = mcya.cod_centro and
      ctos.num_cuenta_req4 = mcya.num_cuenta and
      ctos.cod_divisa = mcya.cod_divisa
    """

    tableAcuerdosEspecialesReq4: """
    select ctos.cod_entidad,ctos.cod_centro,ctos.num_cuenta,ctos.cod_divisa,ae.imp_limite as imp_limite_req4
       from(
        select idf_cto_supra,concat_ws('_',cod_entidad,cod_centro,concat('0',cod_producto,substr(num_cuenta,4,9)),
        cod_producto,cod_subprodu_altair,cod_divisa) as idf_cto_supra_req4,
        cod_entidad,cod_centro,num_cuenta,concat('0',cod_producto,substr(num_cuenta,4,9)) as num_cuenta_req4,cod_producto,cod_subprodu_altair,cod_divisa
        from ${database}.${table}
        where data_date_part = '${loadDate}' and
        cod_producto in ${P_s_Productos_Cuentas_STR} and
        num_cuenta like ('000%')
      ) ctos

      inner join

      (select cod_entidad, cod_centro, num_cuenta, cod_divisa, imp_limite
        from ${database}.acuerdos_especiales
        where data_date_part = '${loadDate}'  and
        cod_estado = 'A' and
        data_date_part >= concat(substr(fec_inicio,1,4),substr(fec_inicio,6,2),substr(fec_inicio,9,2) ) and
        data_date_part <= concat(substr(fec_vencimiento,1,4),substr(fec_vencimiento,6,2),substr(fec_vencimiento,9,2) )

      ) ae on
      ctos.cod_entidad = ae.cod_entidad and
      ctos.cod_centro = ae.cod_centro and
      ctos.num_cuenta_req4 = ae.num_cuenta and
      ctos.cod_divisa = ae.cod_divisa
    """

    tablePromocionesReq4: """
    select ctos.cod_entidad,ctos.cod_centro,ctos.num_cuenta,ctos.cod_divisa,prom.imp_promocion as imp_limite_req4
       from(
        select idf_cto_supra,concat_ws('_',cod_entidad,cod_centro,concat('0',cod_producto,substr(num_cuenta,4,9)),
        cod_producto,cod_subprodu_altair,cod_divisa) as idf_cto_supra_req4,
        cod_entidad,cod_centro,num_cuenta,concat('0',cod_producto,substr(num_cuenta,4,9)) as num_cuenta_req4,cod_producto,cod_subprodu_altair,cod_divisa
        from ${database}.${table}
        where data_date_part = '${loadDate}' and
        cod_producto in ${P_s_Productos_Cuentas_STR} and
        num_cuenta like ('000%')
      ) ctos

      inner join

      (select cod_entidad, cod_centro, num_cuenta, cod_divisa, imp_promocion
        from ${database}.promociones
        where data_date_part = '${loadDate}'  and
        data_date_part >= concat(substr(fec_inicio,1,4),substr(fec_inicio,6,2),substr(fec_inicio,9,2) ) and
        data_date_part <= concat(substr(fec_final,1,4),substr(fec_final,6,2),substr(fec_final,9,2) )

      ) prom on
      ctos.cod_entidad = prom.cod_entidad and
      ctos.cod_centro = prom.cod_centro and
      ctos.num_cuenta_req4 = prom.num_cuenta and
      ctos.cod_divisa = prom.cod_divisa

    """

    tableAcuerdosImpLim: """
     select cod_entidad,cod_centro,num_cuenta,cod_divisa, sum(imp_limite_req4) as imp_limite_req4 from
     (
        select ctos.cod_entidad,ctos.cod_centro,ctos.num_cuenta,ctos.cod_divisa,acuerdos.imp_limite as imp_limite_req4
           from(
            select idf_cto_supra,concat_ws('_',cod_entidad,cod_centro,concat('0',cod_producto,substr(num_cuenta,4,9)),
            cod_producto,cod_subprodu_altair,cod_divisa) as idf_cto_supra_req4,
            cod_entidad,cod_centro,num_cuenta,concat('0',cod_producto,substr(num_cuenta,4,9)) as num_cuenta_req4,cod_producto,cod_subprodu_altair,cod_divisa
            from ${database}.${table}
            where data_date_part = '${loadDate}' and
            cod_producto in ${P_s_Productos_Cuentas_STR} and
            num_cuenta like ('000%')
          ) ctos

          inner join

          (select cod_entidad, cod_centro, num_cuenta, cod_divisa, imp_limite
            from ${database}.acuerdos
            where data_date_part = '${loadDate}'  and
            cod_estado = 'A' and
            data_date_part >= concat(substr(fec_inicio,1,4),substr(fec_inicio,6,2),substr(fec_inicio,9,2) ) and
            data_date_part <= concat(substr(fec_vencimiento,1,4),substr(fec_vencimiento,6,2),substr(fec_vencimiento,9,2) )

          ) acuerdos on
          ctos.cod_entidad = acuerdos.cod_entidad and
          ctos.cod_centro = acuerdos.cod_centro and
          ctos.num_cuenta_req4 = acuerdos.num_cuenta and
          ctos.cod_divisa = acuerdos.cod_divisa
     ) foo
     group by  cod_entidad,cod_centro,num_cuenta,cod_divisa
    """

    tableAcuerdosTasaInt: """
     select
       cod_entidad,cod_centro,num_cuenta,cod_divisa,
       sum(tasa_interes*factor_pond) as tasa_int_req4
     from
     (

        select numerador.cod_entidad,numerador.cod_centro,numerador.num_cuenta,numerador.cod_divisa,
        numerador.imp_limite_req4 as imp_num, denominador.imp_limite_req4 as imp_den,
        numerador.imp_limite_req4/denominador.imp_limite_req4 as factor_pond, numerador.tasa_interes from
         ( --numerador
            select ctos.cod_entidad,ctos.cod_centro,ctos.num_cuenta,ctos.cod_divisa,acuerdos.imp_limite as imp_limite_req4, acuerdos.tasa_interes
               from(
                select idf_cto_supra,concat_ws('_',cod_entidad,cod_centro,concat('0',cod_producto,substr(num_cuenta,4,9)),
                cod_producto,cod_subprodu_altair,cod_divisa) as idf_cto_supra_req4,
                cod_entidad,cod_centro,num_cuenta,concat('0',cod_producto,substr(num_cuenta,4,9)) as num_cuenta_req4,cod_producto,cod_subprodu_altair,cod_divisa
                from ${database}.${table}
                where data_date_part = '${loadDate}' and
                cod_producto in ${P_s_Productos_Cuentas_STR} and
                num_cuenta like ('000%')
              ) ctos

              inner join

              (select cod_entidad, cod_centro, num_cuenta, cod_divisa, imp_limite, tasa_interes
                from ${database}.acuerdos
                where data_date_part = '${loadDate}'  and
                concat(substr(fec_vencimiento,1,4),substr(fec_vencimiento,6,2),substr(fec_vencimiento,9,2) ) >='${loadDate}'

              ) acuerdos on
              ctos.cod_entidad = acuerdos.cod_entidad and
              ctos.cod_centro = acuerdos.cod_centro and
              ctos.num_cuenta_req4 = acuerdos.num_cuenta and
              ctos.cod_divisa = acuerdos.cod_divisa
         ) numerador inner join

         ( --denominador
             select cod_entidad,cod_centro,num_cuenta,cod_divisa, sum(imp_limite_req4) as imp_limite_req4 from
             (
                select ctos.cod_entidad,ctos.cod_centro,ctos.num_cuenta,ctos.cod_divisa,acuerdos.imp_limite as imp_limite_req4
                   from(
                    select idf_cto_supra,concat_ws('_',cod_entidad,cod_centro,concat('0',cod_producto,substr(num_cuenta,4,9)),
                    cod_producto,cod_subprodu_altair,cod_divisa) as idf_cto_supra_req4,
                    cod_entidad,cod_centro,num_cuenta,concat('0',cod_producto,substr(num_cuenta,4,9)) as num_cuenta_req4,cod_producto,cod_subprodu_altair,cod_divisa
                    from ${database}.${table}
                    where data_date_part = '${loadDate}' and
                    cod_producto in ${P_s_Productos_Cuentas_STR} and
                    num_cuenta like ('000%')
                  ) ctos

                  inner join

                  (select cod_entidad, cod_centro, num_cuenta, cod_divisa, imp_limite
                    from ${database}.acuerdos
                    where data_date_part = '${loadDate}'  and
                    concat(substr(fec_vencimiento,1,4),substr(fec_vencimiento,6,2),substr(fec_vencimiento,9,2) ) >='${loadDate}'

                  ) acuerdos on
                  ctos.cod_entidad = acuerdos.cod_entidad and
                  ctos.cod_centro = acuerdos.cod_centro and
                  ctos.num_cuenta_req4 = acuerdos.num_cuenta and
                  ctos.cod_divisa = acuerdos.cod_divisa
             ) foo
             group by  cod_entidad,cod_centro,num_cuenta,cod_divisa
        ) denominador on
        numerador.cod_entidad = denominador.cod_entidad and
        numerador.cod_centro = denominador.cod_centro and
        numerador.num_cuenta = denominador.num_cuenta and
        numerador.cod_divisa = denominador.cod_divisa

    ) foo
    --where cod_centro = '0296' and num_cuenta = '000000007216'
    --EN HIVE:   tasa_int = 22200000.0000 BIEN
    --EN IMPALA: tasa_int = 21880000.0000 MAL
    group by  cod_entidad,cod_centro,num_cuenta,cod_divisa
    """

    tableGestionContratosCastigados: """
       select
       concat_ws('_',cod_entidad,cod_centro,num_cuenta,cod_producto,cod_subprodu,cod_divisa) as idf_cto_supra, imp_deuda_contable
       from ${database}.gestion_de_contratos_castigados
       where data_date_part='${loadDate}'
    """

    tableContratosMorosidadMes: """
      select
       idf_cto_supra,
       sum_imp_entrada_mora + nvl(sum_imp_entrada_mora_traspasado, 0.0) as sum_imp_entrada_mora,
       sum_imp_salida_mora + nvl(sum_imp_salida_mora_traspasado, 0.0) as sum_imp_salida_mora,
       sum_imp_incremento_mora + nvl(sum_imp_incremento_mora_traspasado, 0.0) as sum_imp_incremento_mora,
       sum_imp_decremento_mora + nvl(sum_imp_decremento_mora_traspasado, 0.0) as sum_imp_decremento_mora
      from
      (
          select
           t1.idf_cto_supra,
           t1.sum_imp_entrada_mora,
           t1.sum_imp_salida_mora,
           t1.sum_imp_incremento_mora,
           t1.sum_imp_decremento_mora,
           t2.sum_imp_entrada_mora as sum_imp_entrada_mora_traspasado,
           t2.sum_imp_salida_mora as sum_imp_salida_mora_traspasado,
           t2.sum_imp_incremento_mora as sum_imp_incremento_mora_traspasado,
           t2.sum_imp_decremento_mora as sum_imp_decremento_mora_traspasado
           from
          (
               select
                   idf_cto_supra,
                   sum(imp_entrada_mora) as sum_imp_entrada_mora,
                   sum(imp_salida_mora) as sum_imp_salida_mora,
                   sum(imp_incremento_mora) as sum_imp_incremento_mora,
                   sum(imp_decremento_mora) as sum_imp_decremento_mora,
                   max(idf_cto_supra_traspasado) as idf_cto_supra_traspasado
                from ${database}.${table}
                where data_date_part >= '${firstDay}' and data_date_part <= '${lastDay}'
                group by idf_cto_supra

          ) t1 left outer join
          (
               select
                   idf_cto_supra,
                   sum(imp_entrada_mora) as sum_imp_entrada_mora,
                   sum(imp_salida_mora) as sum_imp_salida_mora,
                   sum(imp_incremento_mora) as sum_imp_incremento_mora,
                   sum(imp_decremento_mora) as sum_imp_decremento_mora
                from ${database}.${table}
                where data_date_part >= '${firstDay}' and data_date_part <= '${lastDay}'
                group by idf_cto_supra
          ) t2 on
          t1.idf_cto_supra_traspasado = t2.idf_cto_supra
      ) foo
    """

    tableContratosMorosidadMesGUA: """
       select
           idf_cto_supra_original,
           sum(imp_entrada_mora) as sum_imp_entrada_mora,
           sum(imp_salida_mora) as sum_imp_salida_mora,
           sum(imp_incremento_mora) as sum_imp_incremento_mora,
           sum(imp_decremento_mora) as sum_imp_decremento_mora
        from ${database}.${table}
        where data_date_part >= '${firstDay}' and data_date_part <= '${lastDay}'
        group by idf_cto_supra_original
    """

    tableContratosDuplicados: """
      select idf_cto_supra, '1' as isDuplicate
      from ${database}.${table}
      where data_date_part = '${loadDate}'
      group by idf_cto_supra
      having count(0) > 1
    """

    tableContratosDuplicadosCogerUno: """
       select * from (
	        select *, row_number() over(partition by idf_cto_supra) as row_num
	        from ${database}.${table}
	        where data_date_part = '${loadDate}'
       ) foo where row_num = 1
    """

    tableRelacionCierreSucursal: """
      select idf_cto_supra, idf_cto_supra_traspasado
      from (
            select
               concat_ws("_", cod_entidad,  cod_centro,  num_cuenta,  cod_producto,  cod_subprodu, cod_divisa) as idf_cto_supra_traspasado,
               concat_ws("_", cod_entidadd, cod_centrod, num_cuentad, cod_productod, cod_subprodd, cod_divisad) as idf_cto_supra
            from ${database}.relacion_cierre_sucursal
            where data_date_part = '${loadDate}'
      ) foo
      where idf_cto_supra <> idf_cto_supra_traspasado -- no hace daño
    """

    //En la antigua vista de IFRS9 se agrupaba y se obtenía el máximo de cada uno de los campos.Si no se hace da duplicados.
    tableMarcasRiesgo: """
      select
        concat_ws("_", cod_entidad,  cod_centro,  num_cuenta,  cod_producto,  cod_subprodu, cod_divisa) as idf_cto_supra,
        max(ind_subestandar) ind_subestandar, max(coef_rating_ini) coef_rating_ini, max(ind_vigilancia_especial) ind_vigilancia_especial, max(distribucion_productos) distribucion_productos,
        max(ind_mora_pcr09) ind_mora_pcr09, max(ind_mora_pcr16) ind_mora_pcr16, max(fec_entrada_mora_pcr09) fec_entrada_mora_pcr09,max(fec_entrada_mora_pcr16) fec_entrada_mora_pcr16,
        max(num_meses_mora_pcr09_lgd) num_meses_mora_pcr09_lgd, max(num_meses_mora_pcr16_lgd) num_meses_mora_pcr16_lgd, max(ind_cura_pcr09) ind_cura_pcr09, max(ind_cura_pcr16) ind_cura_pcr16,
        max(ind_default_pd_pcr09) ind_default_pd_pcr09, max(ind_default_pd_pcr16) ind_default_pd_pcr16, max(ind_redistrib_primas_genericas) ind_redistrib_primas_genericas
      from ${database}.marcas_riesgo
      where data_date_part = '${max_data_date_part}'
      group by cod_entidad,  cod_centro,  num_cuenta,  cod_producto,  cod_subprodu, cod_divisa
    """

    tableMarcaExclusion: """
      select
        concat_ws("_", cod_entidad,  cod_centro,  num_cuenta,  cod_producto,  cod_subprodu, cod_divisa) as idf_cto_supra,
        supra_source
      from ${database}.marca_exclusion
      where data_date_part = '${max_data_date_part}'
    """

    tableVuelcoContratos: """
      select
        concat_ws("_", cod_entidad,  cod_centro,  num_cuenta,  cod_producto,  cod_subprodu, cod_divisa) as idf_cto_supra,
        max(num_cuenta) as num_cuenta_vc
      from ${database}.vuelco_contratos
      where data_date_part = '${max_data_date_part}'
      group by cod_entidad,  cod_centro,  num_cuenta,  cod_producto,  cod_subprodu, cod_divisa
    """

    tableContratosDeudoresAdic: """
      select
        supra_source,
        concat_ws("_", cod_entidad,  cod_centro,  num_cuenta,  cod_producto,  cod_subprodu, cod_divisa) as idf_cto_supra
      from ${database}.contratos_deudores_adic
      where data_date_part = '${max_data_date_part}'
      group by supra_source, cod_entidad,  cod_centro,  num_cuenta,  cod_producto,  cod_subprodu, cod_divisa
    """

    tableDetalleContratosContingente: """
    select
     concat_ws("_", cod_entidad_sis_origen,  cod_centro,  num_cuenta,  cod_producto,  cod_subprodu, cod_moneda) as idf_cto_supra_contingente,
     max(nup_sujeto_rgo) as nup_sujeto_rgo_contingente
    from ${database}.detalle_contratos_contingente
    where data_date_part = '${max_data_date_part_contingente}' and cod_producto = ${P_s_Comercio_Exterior_STR} and nup_sujeto_rgo != ''
    group by cod_entidad_sis_origen,  cod_centro,  num_cuenta,  cod_producto,  cod_subprodu, cod_moneda
    """

    tableDetalleContratosBanktrade: """
    select
     concat_ws("_", cod_entidad_sis_origen,  cod_centro,  num_cuenta,  cod_producto,  cod_subprodu, cod_moneda) as idf_cto_supra_banktrade,
     max(nup_sujeto_rgo) as nup_sujeto_rgo_banktrade
    from ${database}.detalle_contratos_banktrade
    where data_date_part = '${max_data_date_part_banktrade}' and cod_producto = ${P_s_Comercio_Exterior_STR} and nup_sujeto_rgo != ''
    group by cod_entidad_sis_origen,  cod_centro,  num_cuenta,  cod_producto,  cod_subprodu, cod_moneda
    """

    tableIdfCtoSupraDiaAnterior: """
      select idf_cto_supra, idf_cto_supra_traspasado as idf_cto_supra_traspasado_anterior
      from ${database}.${table}
      where data_date_part = ${laborableAnterior}
    """

    tableDtCtoOds: """
    select idf_cto_supra, max(fec_baja_rel_cliente) as fec_baja_rel_cliente, max(cod_estado_rel_cliente) as cod_estado_rel_cliente
    from
    (
          select concat_ws("_", cod_entidad,  cod_centro,  num_cuenta,  cod_producto,  cod_subprodu_altair, cod_divisa) as idf_cto_supra,
          fec_baja_rel_cliente, cod_estado_rel_cliente
          from ${database}.dt_cto_ods where data_date_part = '${loadDate}'
    ) foo
    group by idf_cto_supra
    """

    //idf_cto_supra = entidad + centro + cuenta + producto + subproducto + divisa
    createTableDtCtoOds: """
    CREATE TABLE IF NOT EXISTS ${database}.dt_cto_ods (
      fec_data INT,
      idf_cto_ods STRING,
      idf_cto_supra STRING,
      cod_entidad STRING,
      cod_centro STRING,
      num_cuenta STRING,
      cod_producto STRING,
      cod_producto_altair STRING,
      cod_subprodu STRING,
      cod_subprodu_altair STRING,
      cod_divisa STRING,
      fec_alta_cto INT,
      fec_vencimiento INT,
      num_dia_demora INT,
      cod_sis_origen STRING,
      cod_contenido STRING,
      plz_contractual INT,
      imp_ini_mo DECIMAL(21,4),
      imp_cambio_fijo DECIMAL(21,4),
      imp_ini_mo_contraval DECIMAL(21,4),
      imp_lim_credito_ml DECIMAL(21,4),
      imp_disp_ml DECIMAL(21,4),
      tabla_origen STRING,

      num_persona STRING,
      fec_alta_rel_cliente STRING,

      cod_met_amrt STRING,
      cod_tip_tasa STRING,
      cod_uni_fre_pago_int STRING,
      cod_uni_plz_amrt STRING,
      tasa_int DECIMAL(21,4),

      fec_baja_rel_cliente STRING,
      cod_estado_rel_cliente STRING

       ) partitioned by (
        data_date_part STRING
       )
        stored as parquet
    """




    createTableContratos: """
    CREATE TABLE IF NOT EXISTS ${database}.${table} (

      fec_data STRING,
      idf_cto_supra STRING,

      idf_cto_ods STRING,
      cod_sis_origen STRING,
      cod_entidad STRING,
      cod_centro STRING,
      num_cuenta STRING,
      cod_producto STRING,
      cod_subprodu_altair STRING,
      cod_divisa STRING,

      cod_contenido STRING,
      fec_alta_cto INT,
      fec_vencimiento INT,
      imp_ini_mo DECIMAL(21,4),
      imp_lim_credito_ml DECIMAL(21,4),
      imp_disp_ml DECIMAL(21,4),
      num_dia_demora INT,
      plz_contractual INT,

      cod_met_amrt STRING,
      cod_tip_tasa STRING,
      cod_uni_fre_pago_int STRING,
      cod_uni_plz_amrt STRING,
      tasa_int DECIMAL(21,4),

      num_persona STRING,
      fec_alta_rel_cliente STRING,

      cod_marca STRING,
      cod_submarca STRING,
      imp_riesgo DECIMAL(21,4),
      fec_sit_irregular STRING,
      fec_marca_submarca STRING,

      situacion_bcra STRING,
      imp_prevision DECIMAL(21,4),
      imp_deuda DECIMAL(21,4),

      cod_reesctr STRING,
      ind_refinanciacion STRING,

      cod_estado STRING,
      imp_tot_ajuste_capital DECIMAL(21,4),
      imp_total_impuesto DECIMAL(21,4),
      imp_total_interes DECIMAL(21,4),
      imp_interes_documentado DECIMAL(21,4),
      imp_total_capital DECIMAL(21,4),
      fec_castigo STRING,

      imp_gastos_moria DECIMAL(21,4),
      imp_total_canc_contrato DECIMAL(21,4),

      imp_escritura DECIMAL(21,4),
      imp_valor_real DECIMAL(21,4),

      cod_marca_subjetiva STRING,
      cod_submarca_subjetiva STRING,

      ind_producto_riesgo STRING,

      imp_adsf_cap DECIMAL(21,4),
      imp_adsf_int_dev DECIMAL(21,4),
      imp_adsf_int_doc DECIMAL(21,4),
      imp_adsf_iva_pend_cob DECIMAL(21,4),
      imp_adsf_seg DECIMAL(21,4),
      imp_adsf_acdo_no_utlz DECIMAL(21,4),
      imp_adsf_ajustes DECIMAL(21,4),

      num_dias_para_vcmto INT,

      cod_marca_definitiva STRING,
      cod_submarca_definitiva STRING,

      ind_moroso INT,
      ind_performing INT,

      ind_demora_1_30 INT,
      ind_demora_31_60 INT,
      ind_demora_61_90 INT,
      ind_demora_91_120 INT,
      ind_demora_121_150 INT,
      ind_demora_151_180 INT,
      ind_demora_mas_180 INT,

      imp_entrada_mora DECIMAL(21,4),
      imp_salida_mora DECIMAL(21,4),
      imp_incremento_mora DECIMAL(21,4),
      imp_decremento_mora DECIMAL(21,4),

      num_meses_vigencia INT,
      num_meses_vencimiento INT,
      imp_no_dispuesto DECIMAL(21,4),

      mes_inact_tdc INT,

      provision_amount DECIMAL(21,4),
      pd_lt_ifrs9_temporal STRING,
      final_stage DECIMAL(21,4),

      cod_est_cta INT,
      imp_lim_cpra_cuo DECIMAL(21,4),

      portfolio_ifrs9 STRING,

      imp_max_cobertura DECIMAL(21,4),
      ind_mas1reco INT,
      ind_contingente INT,

      idf_cto_supra_traspasado STRING,

      fec_abandono_con_seguimiento STRING,
      fec_abandono_total STRING,

      idf_cto_supra_original STRING,

      cod_marca_refinanciado STRING,
      cod_submarca_refinanciado STRING,

      cod_perfil_inversion INT,
      ind_inversion_sin_perfilar STRING,
      ind_inversion_conservador STRING,
      ind_inversion_moderado STRING,
      ind_inversion_arriesgado STRING,
      ind_sujeto_perfil_inversion STRING,

      cod_atribuido_a_segmento_especial STRING,

      imp_deuda_contable DECIMAL(21,4),
      imp_total_contable DECIMAL(21,4),
      imp_interes_cps DECIMAL(21,4),
      imp_interes_mor DECIMAL(21,4),

      tipo_score_adm STRING,
      fec_ingreso_sco STRING,
      cod_final_score INT,

      ind_subestandar INT,
      coef_rating_ini DECIMAL(6,3),
      ind_vigilancia_especial INT,
      distribucion_productos STRING,
      ind_mora_pcr09 INT,
      ind_mora_pcr16 INT,
      fec_entrada_mora_pcr09 STRING,
      fec_entrada_mora_pcr16 STRING,
      num_meses_mora_pcr09_lgd smallint,
      num_meses_mora_pcr16_lgd smallint,
      ind_cura_pcr09 INT,
      ind_cura_pcr16 INT,
      ind_default_pd_pcr09 INT,
      ind_default_pd_pcr16 INT,
      ind_redistrib_primas_genericas INT,

      exclusion_30d smallint,
      ind_cartera_citi STRING,
      marca_ptmo_personal STRING,
      num_persona_suj_rgo STRING,

      imp_pago_minimo DECIMAL(21,4),

      fec_baja_rel_cliente STRING,
      cod_estado_rel_cliente STRING,

      cod_destino_fondos STRING

       ) partitioned by (
        data_date_part STRING
       )
        stored as parquet
    """


    createTableContratosInconsistencias: """
    CREATE TABLE IF NOT EXISTS ${database}.${table}_inconsistencias (

      fec_data INT,
      idf_cto_supra STRING,
      razon STRING

       ) partitioned by (
        data_date_part STRING
       )
        stored as parquet
    """

    createTableArgStaging: """
    CREATE TABLE ${ifrs9_database}.${P_s_Modellica_Modellica_Staging_Tablename} (
       idf_cto_ifrs STRING,
       provision_amount DECIMAL(30,15),
       final_stage STRING,
       bucket_part STRING,
       fin_part STRING,
       exec_id_part STRING
       ) partitioned by (
       data_date_part STRING,
       data_timestamp_part STRING
       )
         stored as parquet
    """

    createTableArgExpectedLoss: """
    CREATE TABLE ${ifrs9_database}.${P_s_Modellica_Modellica_ExpectedLoss_Tablename} (
       idf_cto_ifrs STRING,
       portfolio_ifrs9 STRING,
       pd_lt_ifrs9_temporal STRING,
       bucket_part STRING,
       fin_part STRING,
       exec_id_part STRING
       ) partitioned by (
       data_date_part STRING,
       data_timestamp_part STRING
       )
         stored as parquet
    """

  }


}
