SET mapred.job.queue.name=root.dataeng;
SELECT  PENUMPER, 
        MAX(CASE WHEN RUBRO IN ('7534','7531','5983','5013','5533','5532','5511','7542','4784','5521','5542','7538','7523','5541') THEN 1 ELSE 0 END) AS FLAG_CONS_ASOCIADO_AUTOS,
        MAX(CASE WHEN RUBRO IN ('5712',	'9018',	'5935',	'5732',	'5198',	'5200',	'5722',	'4915',	'5231',	'5072',	'5719',	'5713',	'1750',	'5039',	'5211',	'1711',	'1761',	'1731',	'5074',	'4225',	'7535') THEN 1 ELSE 0 END) AS FLAG_CONS_ASOCIADO_VIVIENDA
FROM TRJ.TMOV_VISA
WHERE AS_OF_DATE BETWEEN date'{}' and date'{}'
and PENUMPER is not null
GROUP BY PENUMPER